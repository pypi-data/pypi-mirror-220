"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[832],{22737:(t,e,n)=>{var i=n(47169),a=n(13613),o=n(63025),r=n(95023),s=n.n(r),c=n(95161),l=n.n(c),d=n(53806),u=n.n(d),m=n(32735),b=n(12788),p=(n(95499),n(68101),n(80445)),h=n(8892),f=n(19306),y=n(59090),g=n(12394),v=n(28995),D=n(60216),k=n.n(D),E=n(13213),I=n(53130),C=n(75723),_=n(67986);function x(t){let{open:e,setModalOpen:n,trigger:i,published:a,onClick:o}=t;return m.createElement(E.Z,{open:e,onClose:()=>n(!1),size:"tiny",trigger:i,closeIcon:!0},m.createElement(I.Z,{content:a?f.vN.string("Set contribution list in draft mode"):f.vN.string("Publish contributions")}),m.createElement(E.Z.Content,null,a?m.createElement(m.Fragment,null,m.createElement("p",null,m.createElement(f.vN,null,"Are you sure you want to change the contribution list back to draft mode?")),m.createElement("p",null,m.createElement(f.vN,null,"By doing so the following menu items won't be accessible:"))):m.createElement(m.Fragment,null,m.createElement("p",null,m.createElement(f.vN,null,"Are you sure you want to publish the contribution list?")),m.createElement("p",null,m.createElement(f.vN,null,"By doing so the following menu items will be accessible:"))),m.createElement(C.Z,{bulleted:!0},m.createElement(C.Z.Item,null,m.createElement(f.vN,null,"Contribution List")),m.createElement(C.Z.Item,null,m.createElement(f.vN,null,"My Contributions")),m.createElement(C.Z.Item,null,m.createElement(f.vN,null,"Author List")),m.createElement(C.Z.Item,null,m.createElement(f.vN,null,"Speaker List")),m.createElement(C.Z.Item,null,m.createElement(f.vN,null,"Timetable")),m.createElement(C.Z.Item,null,m.createElement(f.vN,null,"Book of Abstracts")))),m.createElement(E.Z.Actions,null,m.createElement(_.Z,{onClick:()=>n(!1)},m.createElement(f.vN,null,"No")),m.createElement(_.Z,{primary:!0,onClick:o},m.createElement(f.vN,null,"Yes"))))}x.propTypes={open:k().bool.isRequired,setModalOpen:k().func.isRequired,trigger:k().node.isRequired,published:k().bool.isRequired,onClick:k().func.isRequired};const w=o.ZP.bind(null,{endpoint:"contributions.manage_publication",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contributions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"published",isDynamic:!1}]}]},"/");function j(t){let{eventId:e,onSuccess:n}=t;const i=w({event_id:e}),[a,o]=(0,m.useState)(!1),r=m.createElement(h.IButton,{onClick:()=>o(!0)},m.createElement(f.vN,null,"Publish contributions"));return m.createElement(x,{open:a,setModalOpen:o,trigger:r,published:!1,onClick:async()=>{try{await y.indicoAxios.put(i)}catch(t){return(0,y.handleAxiosError)(t)}n(),o(!1)}})}j.propTypes={eventId:k().string.isRequired,onSuccess:k().func.isRequired};var O=n(41187),S=n(88021);const T=o.ZP.bind(null,{endpoint:"contributions.manage_publication",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contributions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"published",isDynamic:!1}]}]},"/");function N(t){let{eventId:e}=t;const[n,i]=(0,m.useState)(!1),[a,o,r,s]=(0,S.RF)(T({event_id:e}));if(r)return null;const c=m.createElement(O.Z,{label:a?f.vN.string("Published"):f.vN.string("Draft"),toggle:!0,onClick:()=>i(!0),checked:a,disabled:s});return m.createElement(x,{open:n,setModalOpen:i,trigger:c,published:a,onClick:()=>{o(),i(!1)}})}N.propTypes={eventId:k().string.isRequired};const P=["id"];function A(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function L(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?A(Object(n),!0).forEach((function(e){(0,i.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}const Z=o.ZP.bind(null,{endpoint:"event_editing.api_file_types",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"file-types",isDynamic:!1}]}]},"/"),q=o.ZP.bind(null,{endpoint:"papers.api_paper_details",rules:[{args:["contrib_id","event_id"],converters:{contrib_id:"IntegerConverter",event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"papers",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contrib_id",isDynamic:!0}]}]},"/");document.addEventListener("DOMContentLoaded",(()=>{const t=document.querySelector("#contribution-calendar-link");if(!t)return;const{contributionId:e,eventId:n}=t.dataset;b.render(m.createElement(h.ICSCalendarLink,{endpoint:"contributions.export_ics",params:{event_id:n,contrib_id:e},renderButton:t=>m.createElement(h.IButton,{icon:"calendar",classes:t,title:f.vN.string("Export")}),options:[{key:"contribution",text:f.vN.string("Contribution"),extraParams:{}}]}),t)})),function(t){function e(t){$(t).tablesorter({cssAsc:"header-sort-asc",cssDesc:"header-sort-desc",cssInfoBlock:"avoid-sort",headerTemplate:"",sortList:[[1,0]]})}function n(t,e,n){return $.ajax({url:t,method:e,data:JSON.stringify(n),dataType:"json",contentType:"application/json",error:handleAjaxError,complete:IndicoUI.Dialogs.Util.progress()})}function i(){$(".js-contrib-start-date").each((function(){const t=$(this);t.ajaxqbubble({url:t.data("href"),qBubbleOptions:{style:{classes:"qbubble-contrib-start-date qtip-allow-overflow"}}})}))}function o(){$(".js-contrib-duration").each((function(){const t=$(this);t.ajaxqbubble({url:t.data("href"),qBubbleOptions:{style:{classes:"qbubble-contrib-duration"}}})}))}t.setupEditableSubmissionButton=async function(){const t=document.querySelector("#editable-submission-button");if(!t)return;const e=JSON.parse(t.dataset.availableTypes),{eventId:n,contributionId:i,contributionCode:o}=t.dataset;let r,s,c=[];try{[r,s]=await Promise.all([Promise.all(e.map((t=>y.indicoAxios.get(Z({event_id:n,type:t}))))),y.indicoAxios.get(q({event_id:n,contrib_id:i}),{validateStatus:t=>t>=200&&t<300||404===t,headers:{"X-Indico-No-Report-Error":"404"}})])}catch(t){return void(0,y.handleAxiosError)(t)}const d=l()(r.map(((t,n)=>[e[n],(0,g.k)(t.data)])));if(s){const{isInFinalState:t,lastRevision:e}=(0,g.k)(s.data);t&&e&&(c=e.files)}b.render(m.createElement(p.Z,{fileTypes:d,eventId:+n,contributionId:+i,contributionCode:o,uploadableFiles:c.map((t=>{let{id:e}=t;return L(L({},(0,a.Z)(t,P)),{},{paperId:e})}))}),t)},t.setupContributionConfig=function(){!function(){const t=document.querySelector("#pub-switch");b.render(m.createElement(N,{eventId:t.dataset.eventId}),t)}()},t.setupContributionList=function(t){t=$.extend({createSessionURL:null,createTrackURL:null,timetableRESTURL:null},t);$(".list [data-toggle=dropdown]").closest(".toolbar").dropdown(),e("#contribution-list .tablesorter"),function(t,e){const i=$("#contribution-list");i.on("click",".session-item-picker",(function(){$(this).itempicker({filterPlaceholder:v.$T.gettext("Filter sessions"),containerClasses:"session-item-container",items:i.find("table").data("session-items"),footerElements:[{title:v.$T.gettext("Assign new session"),onClick(e){ajaxDialog({title:v.$T.gettext("Add new session"),url:t,onClose(t){t&&($(".session-item-picker").each((function(){const e=$(this);e.data("indicoItempicker")?e.itempicker("updateItemList",t.sessions):i.find("table").data("session-items",t.sessions)})),e.itempicker("selectItem",t.new_session_id))}})}}],onSelect(t,i){const a=$(this),o=a[0].style,r={session_id:t?t.id:null};return n(a.data("href"),a.data("method"),r).then((function(r){const s=t?t.title:v.$T.gettext("No session");if(a.find(".label").text(s),t?(o.setProperty("color",`#${t.colors.text}`,"important"),o.setProperty("background",`#${t.colors.background}`,"important")):(o.removeProperty("color"),o.removeProperty("background")),r.unscheduled){const t=a.closest("tr"),o=t.find("td.start-date > .vertical-aligner"),s=o.children().detach();o.html($("<em>",{text:v.$T.gettext("Not scheduled")})),showUndoWarning(v.$T.gettext("'{0}' has been unscheduled due to the session change.").format(t.data("title")),v.$T.gettext("Undo successful! Timetable entry and session have been restored."),(function(){return n(e,"POST",r.undo_unschedule).then((function(t){s.filter(".label").text(" "+u().utc(t.start_dt).format("DD/MM/YYYY HH:mm")),o.html(s),a.itempicker("selectItem",i?i.id:null)}))}))}}))}})}))}(t.createSessionURL,t.timetableRESTURL),function(t){const e=$("#contribution-list");e.on("click",".track-item-picker",(function(){$(this).itempicker({filterPlaceholder:v.$T.gettext("Filter tracks"),containerClasses:"track-item-container",uncheckedItemIcon:"",items:e.find("table").data("track-items"),footerElements:[{title:v.$T.gettext("Add new track"),onClick(n){ajaxDialog({title:v.$T.gettext("Add new track"),url:t,onClose(t){t&&($(".track-item-picker").each((function(){const n=$(this);n.data("indicoItempicker")?n.itempicker("updateItemList",t.tracks):e.find("table").data("track-items",t.tracks)})),n.itempicker("selectItem",t.new_track_id))}})}}],onSelect(t){const e=$(this),i={track_id:t?t.id:null};return n(e.data("href"),e.data("method"),i).then((function(){const n=t?t.title:v.$T.gettext("No track");e.find(".label").text(n)}))}})}))}(t.createTrackURL),i(),o(),enableIfChecked("#contribution-list","input[name=contribution_id]",".js-enable-if-checked");const a=setupListGenerator({itemHandle:"tr",listItems:"#contribution-list tbody tr",term:"#search-input",state:"#filtering-state",placeholder:"#filter-placeholder"});$("#contribution-list").on("indico:htmlUpdated",(function(){e("#contribution-list .tablesorter"),i(),o(),s()(a)})).on("attachments:updated",(function(t){const e=$(t.target);reloadManagementAttachmentInfoColumn(e.data("locator"),e.closest("td"))})),$(".js-submit-form").on("click",(function(t){t.preventDefault();const e=$(this);e.hasClass("disabled")||$("#contribution-list form").attr("action",e.data("href")).submit()}))},t.setupSubContributionList=function(){$("#subcontribution-list [data-toggle=dropdown]").closest(".toolbar").dropdown(),e("#subcontribution-list .tablesorter"),enableIfChecked("#subcontribution-list","input[name=subcontribution_id]","#subcontribution-list .js-enable-if-checked"),$("#subcontribution-list td.subcontribution-title").on("mouseenter",(function(){const t=$(this);this.offsetWidth<this.scrollWidth&&!t.attr("title")&&t.attr("title",t.text())})),$("#subcontribution-list").on("attachments:updated",(function(t){const e=$(t.target);reloadManagementAttachmentInfoColumn(e.data("locator"),e.closest("td")),$(this).trigger("ajaxDialog:setData",[!0])})),$("#subcontribution-list").on("indico:htmlUpdated",(function(){$(this).trigger("ajaxDialog:setData",[!0])})),$("#subcontribution-list table").sortable({items:".js-sortable-subcontribution-row",handle:".js-sort-handle",placeholder:"sortable-placeholder",tolerance:"pointer",distance:10,axis:"y",containment:"#subcontribution-list table",start(t,e){e.placeholder.height(e.helper.outerHeight())},update(t,e){const n=$(this);$.ajax({url:e.item.data("sort-url"),method:"POST",data:{subcontrib_ids:n.sortable("toArray")},error:handleAjaxError}),n.trigger("ajaxDialog:setData",[!0])}})},t.setupEventDisplayContributionList=function(){setupListGenerator({itemHandle:"div.contribution-row",listItems:"#display-contribution-list div.contribution-row",term:"#search-input",state:"#filtering-state",placeholder:"#filter-placeholder"})()},t.setupEventDisplayAuthorList=function(){setupSearchBox({itemHandle:".author-list > li",listItems:".author-list > li",term:"#search-input",state:"#filtering-state",placeholder:"#filter-placeholder"})()},t.setupDraftModeWarning=function(){const t=document.querySelector("#draft-mode-warning"),e=document.querySelector("#draft-mode-warning-button");t&&e&&b.render(m.createElement(j,{eventId:e.dataset.eventId,onSuccess:()=>t.classList.add("hidden")}),e)}}(window)}},t=>{t.O(0,[5514,3044,8592],(()=>{return e=22737,t(t.s=e);var e}));t.O()}]);
//# sourceMappingURL=module_events.contributions.f6431830.bundle.js.map
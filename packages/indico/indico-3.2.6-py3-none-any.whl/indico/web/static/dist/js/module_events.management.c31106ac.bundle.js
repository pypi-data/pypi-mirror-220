(self.webpackChunk=self.webpackChunk||[]).push([[3827],{98791:()=>{window.setupBadgePrinting=function(e){const t=$("#template"),n=$("#page_layout"),a=$("#dashed_border"),i=$("#page_size"),s=$("#page_orientation"),r=$(".margin-editor"),o=$(".info");function l(e,t,n){({A0:"A2",A1:"A3",A2:"A4",A3:"A5",A4:"A6",A5:"A7",A6:"A8"})[t]===e.format&&n===e.orientation?$("#page_layout option[value='foldable']").prop("disabled",!1):($("#page_layout option[value='foldable']").prop("disabled",!0),"foldable"===$("#page_layout :selected").val()&&$("#page_layout :selected").next().prop("selected",!0))}t.on("change",(function(){const t=$(this),a=e[parseInt(t.val(),10)];n.closest(".form-group").toggle(!!a.backside_tpl_id),n.val("front_only"),l(a,i.val(),s.val())})).change(),n.on("change",(function(){r.add(o).toggle("foldable"!==$(this).val()),a.closest(".form-group").toggle("foldable"!==$(this).val())})).change(),i.add(s).on("change",(function(){l(e[parseInt(t.val(),10)],i.val(),s.val()),n.change()})).change()}},60958:(e,t,n)=>{"use strict";var a=n(20011),i=n(90567),s=n.n(i),r=n(32735),o=n(12788),l=(n(17388),n(70967),n(98791),n(60216)),c=n.n(l),d=n(19306),m=n(63025),u=n(13213),v=n(67986),g=n(73537),p=n(41612),_=n(25899),y=n(88021),h=n(32695),f=n(13613),b=n(47169),E=n(33344),D=n(59090);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){(0,b.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const C=m.ZP.bind(null,{endpoint:"persons.api_email_event_persons_metadata",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"persons",isDynamic:!1},{data:"/",isDynamic:!1},{data:"email",isDynamic:!1},{data:"/",isDynamic:!1},{data:"metadata",isDynamic:!1}]}]},"/"),I=m.ZP.bind(null,{endpoint:"persons.api_email_event_persons_send",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"persons",isDynamic:!1},{data:"/",isDynamic:!1},{data:"email",isDynamic:!1},{data:"/",isDynamic:!1},{data:"send",isDynamic:!1}]}]},"/"),j=m.ZP.bind(null,{endpoint:"persons.email_event_persons_preview",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"persons",isDynamic:!1},{data:"/",isDynamic:!1},{data:"email",isDynamic:!1},{data:"/",isDynamic:!1},{data:"preview",isDynamic:!1}]}]},"/");function k(e){let{eventId:t,roleIds:n,persons:a,onClose:i,onSubmitSucceeded:s,noAccount:o,notInvitedOnly:l,successTimeout:c}=e;const[d,m]=(0,r.useState)(0),u={role_id:n,persons:a,no_account:o,not_invited_only:l},{data:v,loading:_}=(0,y.K3)({url:C({event_id:t}),method:"POST",data:u}),{senders:f=[],recipients:b=[],subject:S,body:k,placeholders:R=[]}=v||{};return _?r.createElement(g.Z,{active:!0,page:!0,inverted:!0},r.createElement(p.Z,null)):r.createElement(h.d,{onSubmit:async e=>{const n=N(N({},e),u);let a;n.body=n.body.getData?n.body.getData():n.body;try{a=await D.indicoAxios.post(I({event_id:t}),n)}catch(e){return(0,E.qf)(e)}m(a.data.count),s(a.data.count),setTimeout((()=>i()),c)},onClose:i,onSubmitSucceeded:s,senders:f,recipients:b,previewURL:j({event_id:t}),previewContext:u,placeholders:R,initialFormValues:{subject:S,body:k},sentEmailsCount:d})}k.propTypes={eventId:c().number.isRequired,roleIds:c().arrayOf(c().number),persons:c().arrayOf(c().string),onClose:c().func.isRequired,onSubmitSucceeded:c().func,noAccount:c().bool,notInvitedOnly:c().bool,successTimeout:c().number},k.defaultProps={roleIds:[],persons:[],onSubmitSucceeded:void 0,noAccount:!1,notInvitedOnly:!1,successTimeout:5e3};var R=n(68419);const w=["eventId","roleId","persons","personSelector","triggerSelector","noAccount","notInvitedOnly","onSubmitSucceeded","successTimeout"];function q(e){let{eventId:t,roleId:n,persons:i,personSelector:s,triggerSelector:o,noAccount:l,notInvitedOnly:c,onSubmitSucceeded:m,successTimeout:u}=e,g=(0,f.Z)(e,w);const[p,_]=(0,r.useState)(!1);return i=s?(0,R.s)(s,!1):i,(0,r.useEffect)((()=>{if(!o)return;const e=()=>_(!0),t=document.querySelector(o);return t.addEventListener("click",e),()=>t.removeEventListener("click",e)}),[o]),r.createElement(r.Fragment,null,!o&&r.createElement(v.Z,(0,a.Z)({onClick:()=>_(!0),disabled:!(n||i.length)},g),r.createElement(d.vN,null,"Send emails")),p&&r.createElement(k,{eventId:t,roleIds:n&&[n],persons:i,noAccount:l,notInvitedOnly:c,onClose:()=>_(!1),onSubmitSucceeded:m,successTimeout:u}))}q.propTypes={eventId:c().number.isRequired,roleId:c().number,persons:c().arrayOf(c().string),personSelector:c().string,triggerSelector:c().string,noAccount:c().bool,notInvitedOnly:c().bool,onSubmitSucceeded:c().func,successTimeout:c().number},q.defaultProps={roleId:void 0,persons:[],personSelector:void 0,triggerSelector:void 0,noAccount:!1,notInvitedOnly:!1,onSubmitSucceeded:void 0,successTimeout:void 0};var O=n(98978),A=n.n(O),Z=n(27286),x=n(41187),T=n(59965),P=n(37314);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){(0,b.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const U=e=>A()(e,"identifier");function F(e,t){return"CHANGE_SORT"===t.type?e.column!==t.column?{column:t.column,sortedPersons:U(e.sortedPersons).sort(((e,n)=>e[t.column].localeCompare(n[t.column]))),direction:"ascending"}:"ascending"===e.direction?{column:e.column,sortedPersons:e.sortedPersons.slice().reverse(),direction:"descending"}:{column:null,sortedPersons:U(e.sortedPersons),direction:null}:e}const H=e=>{let{primaryAuthor:t,secondaryAuthor:n}=e;return[t&&d.vN.string("Primary"),n&&d.vN.string("Co-author")].filter((e=>e)).join(", ")||"-"};function B(e){let{persons:t,selectedPersons:n,onChangeSelection:a,isSelectable:i,isVisible:s,extraRoles:o}=e;const[l,c]=(0,r.useReducer)(F,{column:null,sortedPersons:U(t).map((e=>L(L({},e),{},{authorType:H(e),selectable:i(e)}))),direction:null}),{column:m,sortedPersons:u,direction:v}=l,g=u.filter((e=>s(e))),p=g.filter((e=>e.selectable)),_=n.filter((e=>s(t.find((t=>t.identifier===e))))).length,y=[...o,{icon:"mic",isActive:e=>e.speaker,titleActive:d.vN.string("This person is a speaker"),titleInactive:d.vN.string("This person is not a speaker")}];return r.createElement(Z.Z,{sortable:!0,selectable:!0,singleLine:!0},r.createElement(Z.Z.Header,null,r.createElement(Z.Z.Row,null,r.createElement(Z.Z.HeaderCell,{disabled:!0,colSpan:"2"},r.createElement(x.Z,{indeterminate:_>0&&_<p.length,checked:_>0&&_===p.length,onChange:(e,t)=>{return n=t.checked,void a(n?p.map((e=>e.identifier)):[]);var n},disabled:!p.length})),r.createElement(d.vN,{as:Z.Z.HeaderCell,sorted:"fullName"===m?v:null,onClick:()=>c({type:"CHANGE_SORT",column:"fullName"})},"Name"),r.createElement(d.vN,{as:Z.Z.HeaderCell,sorted:"email"===m?v:null,onClick:()=>c({type:"CHANGE_SORT",column:"email"})},"Email"),r.createElement(d.vN,{as:Z.Z.HeaderCell,sorted:"affiliation"===m?v:null,onClick:()=>c({type:"CHANGE_SORT",column:"affiliation"})},"Affiliation"),r.createElement(d.vN,{as:Z.Z.HeaderCell,sorted:"authorType"===m?v:null,onClick:()=>c({type:"CHANGE_SORT",column:"authorType"})},"Author type"),r.createElement(d.vN,{as:Z.Z.HeaderCell,disabled:!0},"Roles"))),r.createElement(Z.Z.Body,null,g.map((e=>r.createElement(Z.Z.Row,{key:e.identifier,style:e.selectable?{}:{opacity:"50%"},onClick:()=>(e=>{let{identifier:t,selectable:i}=e;i&&(n.includes(t)?a(n.filter((e=>e!==t))):a([...n,t]))})(e)},r.createElement(Z.Z.Cell,{collapsing:!0},r.createElement(x.Z,{disabled:!e.selectable,checked:n.includes(e.identifier)})),r.createElement(Z.Z.Cell,{collapsing:!0},r.createElement(T.Z,{content:e.registered?d.vN.string("This person is registered for the event"):d.vN.string("This person is not yet registered"),position:"bottom center",inverted:!0,trigger:r.createElement("i",{className:"icon-ticket "+(e.registered?"":"inactive")})})),r.createElement(Z.Z.Cell,null,e.fullName),r.createElement(Z.Z.Cell,null,e.email),r.createElement(Z.Z.Cell,null,e.affiliation),r.createElement(Z.Z.Cell,null,e.authorType),r.createElement(Z.Z.Cell,{collapsing:!0},y.map((t=>{let{icon:n,isActive:a,titleActive:i,titleInactive:s}=t;return r.createElement(T.Z,{key:n,content:a(e)?i:s,position:"bottom center",inverted:!0,trigger:r.createElement("i",{key:n,className:`icon-${n} ${a(e)?"":"inactive"}`})})})))))),!g.length&&r.createElement(Z.Z.Row,{warning:!0},r.createElement(Z.Z.Cell,{colSpan:"7"},r.createElement(P.Z,{name:"attention"}),r.createElement(d.vN,null,"No persons were found matching the selected criteria.")))))}B.propTypes={persons:c().arrayOf(c().shape({identifier:c().string.isRequired,fullName:c().string.isRequired,email:c().string.isRequired,affiliation:c().string.isRequired,speaker:c().bool.isRequired,primaryAuthor:c().bool.isRequired,secondaryAuthor:c().bool.isRequired,registered:c().bool.isRequired})).isRequired,selectedPersons:c().arrayOf(c().string).isRequired,onChangeSelection:c().func.isRequired,isSelectable:c().func,isVisible:c().func,extraRoles:c().arrayOf(c().shape({icon:c().string.isRequired,isActive:c().func.isRequired,titleActive:c().string.isRequired,titleInactive:c().string.isRequired}))},B.defaultProps={isSelectable:()=>!0,isVisible:()=>!0,extraRoles:[]};const z=m.ZP.bind(null,{endpoint:"abstracts.person_list",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"abstracts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"person-list",isDynamic:!1}]}]},"/"),V=m.ZP.bind(null,{endpoint:"contributions.person_list",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contributions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"person-list",isDynamic:!1}]}]},"/"),K=m.ZP.bind(null,{endpoint:"sessions.person_list",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"sessions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"person-list",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),Q={abstracts:{idType:"abstract_id",personListURL:z},contributions:{idType:"contribution_id",personListURL:V,emptyListMessage:d.vN.string("There are no persons associated with the selected contributions")},sessions:{idType:"session_id",personListURL:K,emptyListMessage:d.vN.string("There are no persons associated with contributions in the selected sessions")}},G={submitter:{text:d.vN.string("Submitters"),isMatch:e=>e.submitter,contexts:["abstracts"]},speaker:{text:d.vN.string("Speakers"),isMatch:e=>e.speaker},primaryAuthor:{text:d.vN.string("Primary authors"),isMatch:e=>e.primaryAuthor},secondaryAuthor:{text:d.vN.string("Co-authors"),isMatch:e=>e.secondaryAuthor},notRegistered:{text:d.vN.string("Not registered"),isMatch:e=>!e.registered}};function X(e){let{eventId:t,sourceIds:n,objectContext:a,onClose:i}=e;const[s,o]=(0,r.useState)([]),[l,c]=(0,r.useState)(void 0),[m,f]=(0,r.useState)([]),b=new FormData;n.forEach((e=>b.append(Q[a].idType,e)));const{data:E,loading:D}=(0,y.K3)({url:Q[a].personListURL({event_id:t}),method:"POST",data:b,headers:{"content-type":"multipart/form-data"}},{camelize:!0}),S="abstracts"===a?[{icon:"user-check icon",isActive:e=>e.submitter,titleActive:d.vN.string("This person submitted an abstract"),titleInactive:d.vN.string("This person hasn't submitted any abstracts")}]:void 0,N=e=>!m.length||m.some((t=>G[t].isMatch(e))),C=Object.entries(G).filter((e=>{let[,t]=e;return!t.contexts||t.contexts.includes(a)})).map((e=>{let[t,n]=e;return{key:t,content:n.text,onClick:()=>(e=>{f(m.includes(e)?m.filter((t=>t!==e)):[...m,e])})(t),primary:m.includes(t)}}));return r.createElement(u.Z,{open:!0,onClose:()=>i(),size:"large"},r.createElement(u.Z.Header,{content:d.vN.string("Authors list")}),r.createElement(u.Z.Content,null,l&&r.createElement(h.Q,{count:l}),r.createElement("div",null,r.createElement(d.vN,{as:"div",style:{display:"inline-block",fontWeight:"bold",padding:"0.5em"}},"Filter by"),r.createElement(v.Z.Group,{buttons:C,compact:!0})),D||!E?r.createElement(g.Z,{active:!0},r.createElement(p.Z,null)):Object.keys(E.eventPersons).length?r.createElement(B,{persons:Object.values(E.eventPersons),selectedPersons:s,onChangeSelection:e=>o(e),isSelectable:e=>!!e.email,isVisible:N,extraRoles:S}):r.createElement(_.Z,{error:!0},Q[a].emptyListMessage)),r.createElement(u.Z.Actions,null,r.createElement(q,{eventId:t,persons:s.filter((e=>N(E.eventPersons[e]))),onSubmitSucceeded:e=>c(e),successTimeout:0,primary:!0}),r.createElement(d.vN,{as:v.Z,onClick:()=>i()},"Close")))}function W(e){let{eventId:t,objectContext:n,paramsSelector:a}=e;const[i,s]=(0,r.useState)(!1),o=(0,R.s)(a);return r.createElement(r.Fragment,null,r.createElement("button",{type:"button",className:"i-button icon-users js-requires-selected-row disabled",onClick:e=>{e.target.classList.contains("disabled")||s(!0)}},r.createElement(d.vN,null,"Authors list")),i&&r.createElement(X,{eventId:t,sourceIds:o,objectContext:n,onClose:()=>s(!1)}))}X.propTypes={eventId:c().number.isRequired,sourceIds:c().arrayOf(c().number).isRequired,objectContext:c().oneOf(Object.keys(Q)).isRequired,onClose:c().func.isRequired},W.propTypes={eventId:c().number.isRequired,objectContext:c().oneOf(Object.keys(Q)).isRequired,paramsSelector:c().string.isRequired};var Y=n(78311),J=n(28995),ee=n(17816),te=n(72963),ne=n(89793),ae=n.n(ne),ie=n(53806),se=n.n(ie),re=n(74763),oe=n(68301),le=n(75723),ce=n(8892),de=n(54733),me=n(5163);const ue={"evt-list":"events-management-client-js-___SeriesManagement-module__evt-list___PkKqH","evt-item":"events-management-client-js-___SeriesManagement-module__evt-item___5iu8a",detail:"events-management-client-js-___SeriesManagement-module__detail___mXZyy","delete-button":"events-management-client-js-___SeriesManagement-module__delete-button___BZmEH","list-flex":"events-management-client-js-___SeriesManagement-module__list-flex___DE65m",disabled:"events-management-client-js-___SeriesManagement-module__disabled___CB78C","date-span":"events-management-client-js-___SeriesManagement-module__date-span___8yRl2","category-chain":"events-management-client-js-___SeriesManagement-module__category-chain___SNXOv","event-title":"events-management-client-js-___SeriesManagement-module__event-title___961dm","warning-reason":"events-management-client-js-___SeriesManagement-module__warning-reason___ag6NQ","positive-note":"events-management-client-js-___SeriesManagement-module__positive-note___TNVKv","load-more":"events-management-client-js-___SeriesManagement-module__load-more___6T2U4"},ve=m.ZP.bind(null,{endpoint:"categories.event_search",rules:[{args:["category_id"],converters:{category_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"events",isDynamic:!1},{data:"/",isDynamic:!1},{data:"search-for-series",isDynamic:!1}]}]},"/"),ge=m.ZP.bind(null,{endpoint:"event_series.event_series",rules:[{args:["series_id"],converters:{series_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event-series",isDynamic:!1},{data:"/",isDynamic:!1},{data:"series_id",isDynamic:!0}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event-series",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),pe=m.ZP.bind(null,{endpoint:"events.single_event_api",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"info-for-series",isDynamic:!1}]}]},"/"),_e=(0,me.c)(250),ye=(0,me.c)(250);function he(e){let{eventId:t,categoryId:n,seriesId:a,timezone:i}=e;const s=null!==a,[o,l]=(0,r.useState)(!1),{loading:c,reFetch:m,data:u}=(0,y.K3)(s?ge({series_id:a}):pe({event_id:t}),{manual:!0}),v=async()=>{await m(),l(!0)},_=u?s?u:{id:null,events:[u],show_sequence_in_title:!1,show_links:!1,event_title_pattern:""}:null;return r.createElement(r.Fragment,null,s?r.createElement(ce.IButton,{borderless:!0,icon:"stack",title:d.vN.string("Manage event series"),onClick:v},r.createElement(d.vN,null,"Manage series")):r.createElement(ce.IButton,{borderless:!0,icon:"stack",title:d.vN.string("Create event series"),onClick:v},r.createElement(d.vN,null,"Create series")),r.createElement(g.Z,{active:c,page:!0,inverted:!0},r.createElement(p.Z,null)),o&&r.createElement(fe,{currentEventId:t,categoryId:n,timezone:i,series:_,onClose:()=>{l(!1)}}))}function fe(e){let{currentEventId:t,categoryId:n,series:a,timezone:i,onClose:s}=e;const[o,l]=(0,r.useState)(!1),c=null!==a.id,m=e=>se()(e).tz(i);return r.createElement(r.Fragment,null,r.createElement(de.Yp,{id:"event-series",header:c?d.vN.string("Manage series"):d.vN.string("Create series"),size:"standard",alignTop:!0,onSubmit:async(e,t)=>{const n=c?(0,de.k4)(e,t):(0,de.hS)(e,t);n.events&&(n.event_ids=n.events.map((e=>e.id)),delete n.events);try{c?await D.indicoAxios.patch(ge({series_id:a.id}),n):await D.indicoAxios.post(ge(),n)}catch(e){return(0,E.qf)(e,{event_ids:"events"})}location.reload(),await new Promise((()=>{}))},onClose:s,initialValues:a,disabledUntilChange:c,extraActions:e=>c&&r.createElement(v.Z,{style:{marginRight:"auto"},onClick:()=>l(!0),disabled:e.submitting,negative:!0},r.createElement(d.vN,null,"Delete series")),submitLabel:c?d.vN.string("Update series"):d.vN.string("Create series")},(()=>r.createElement(r.Fragment,null,r.createElement(E.HS,{name:"events",isEqual:(e,t)=>ae()((e||[]).map((e=>e.id)),(t||[]).map((e=>e.id))),validate:e=>{if(!e.length)return d.vN.string("A series needs to contain at least one event.")},component:be,localMoment:m,categoryId:n,currentEventId:t,existingSeriesId:a.id,divider:r.createElement(re.Z,{horizontal:!0},c?r.createElement(d.vN,null,"Events in series"):r.createElement(d.vN,null,"Events to add"))}),r.createElement(re.Z,{horizontal:!0},r.createElement(d.vN,null,"Series options")),r.createElement(E.fw,{name:"show_sequence_in_title",label:d.vN.string("Show the sequence number in the event titles (lectures only)")}),r.createElement(E.fw,{name:"show_links",label:d.vN.string("Show links to the other events of the series on the main event page")}),r.createElement(E._t,{name:"event_title_pattern",label:d.vN.string("Event title pattern"),description:r.createElement(d.vN,null,"Title pattern for cloned events. Must contain the"," ",r.createElement(d.dO,{name:"placeholder",wrapper:r.createElement("code",null),value:"{n}"})," placeholder which will indicate the new event's position in the series."),validate:e=>{if(e&&!e.includes("{n}"))return d.vN.string("Title pattern must contain the {placeholder} placeholder",{placeholder:"{n}"})}})))),r.createElement(ce.RequestConfirmDelete,{open:o,onClose:()=>l(!1),requestFunc:async()=>{try{await D.indicoAxios.delete(ge({series_id:a.id}))}catch(e){return(0,D.handleAxiosError)(e),!0}location.reload()},persistent:!0},r.createElement(d.vN,null,"Do you really want to delete this series? The associated events will not be deleted.")))}function be(e){let{value:t,onChange:n,onFocus:a,onBlur:i,divider:s,localMoment:o,categoryId:l,currentEventId:c,existingSeriesId:m}=e;const[u,g]=(0,r.useState)(void 0),[p,_]=(0,r.useState)([]),[y,h]=(0,r.useState)(!1),[f,b]=(0,r.useState)(!1),[E,S]=(0,r.useState)(null),N=null!==m,C=async e=>{let t;try{t=await ye((()=>D.indicoAxios.get(pe({event_id:+e}))))}catch(e){return void(0,D.handleAxiosError)(e)}if(null===t.data)S(d.vN.string("No event found with this ID."));else if(t.data.can_access){if(t.data.category_chain)return _([t.data]),S(null),void b(!1);S(d.vN.string("This event is unlisted."))}else S(d.vN.string("You don't have rights to access this event."));b(!1),_([])},I=async function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{t=await _e((()=>D.indicoAxios.get(ve({category_id:l,q:e,offset:n}))))}catch(e){return void(0,D.handleAxiosError)(e)}_(a?[...p,...t.data.events]:t.data.events),h(t.data.has_more),S(null),b(!1)},j=new Set(t.map((e=>e.id)));let k=p.map((e=>({key:e.id,value:e.id,text:e.title,disabled:!e.can_manage||!e.category_chain||e.series_id!==m&&null!==e.series_id||j.has(e.id),content:r.createElement("div",{className:"events-management-client-js-___SeriesManagement-module__list-flex___DE65m"},r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__date-span___8yRl2"},o(e.start_dt).format("ll")),r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__event-title___961dm"},e.title,r.createElement("br",null),r.createElement(ce.TooltipIfTruncated,null,r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__category-chain___SNXOv"},e.category_chain?e.category_chain.join(" » "):r.createElement(d.vN,null,"Unlisted"))),!e.can_manage&&r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__warning-reason___ag6NQ"},r.createElement("br",null),r.createElement(d.vN,null,"You do not have editing rights for this event.")),!e.category_chain&&r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__warning-reason___ag6NQ"},r.createElement("br",null),r.createElement(d.vN,null,"This event is unlisted.")),e.series_id!==m&&null!==e.series_id&&r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__warning-reason___ag6NQ"},r.createElement("br",null),r.createElement(d.vN,null,"This event is already part of a different series.")),j.has(e.id)&&r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__positive-note___TNVKv"},r.createElement("br",null),r.createElement(d.vN,null,"This event is already part of this series."))))})));const R=()=>{b(!0),I(u.trim(),p.length,!0)};return k.length>0&&y&&(k=[...k,{key:"_",value:"_",className:ue["load-more"],content:r.createElement("div",{onClick:e=>{e.stopPropagation()}},r.createElement(v.Z,{primary:!0,compact:!0,size:"small",type:"button",loading:f,onClick:R},r.createElement(d.vN,null,"Load more")))}]),r.createElement(r.Fragment,null,r.createElement(oe.Z,{fluid:!0,selection:!0,search:e=>e,icon:"search",closeOnChange:!1,selectOnBlur:!1,selectOnNavigation:!1,placeholder:d.vN.string("Search for an event title or paste an event URL or event ID (#123)"),options:k,value:null,loading:f,onSearchChange:async(e,t)=>{let{searchQuery:n}=t;if(h(!1),g(n),n=n.trim(),S(null),!n)return b(!1),void _([]);const a=new RegExp(`^${location.origin.replace("/","\\/")}\\/event\\/([0-9]+)`),i=n.match(a);i?(b(!0),C(i[1])):/^#([0-9])+$/.test(n)?(b(!0),C(n.substr(1))):"#"!==n&&(b(!0),I(n))},searchQuery:u,onChange:(e,a)=>{let{value:i}=a;if("_"===i)return;const s=p.find((e=>e.id===i)),r=[...t,s].sort(((e,t)=>se()(e.start_dt)-se()(t.start_dt)));n(r)},onFocus:a,onBlur:i,noResultsMessage:f?d.vN.string("Searching..."):null!==E?E:u?d.vN.string("No results found."):d.vN.string("Enter search term")}),s,r.createElement(le.Z,{divided:!0,relaxed:!0,className:"events-management-client-js-___SeriesManagement-module__evt-list___PkKqH"},t.map((e=>r.createElement(le.Z.Item,{key:e.id,className:"events-management-client-js-___SeriesManagement-module__evt-item___5iu8a"},r.createElement(le.Z.Content,null,r.createElement("div",{className:"events-management-client-js-___SeriesManagement-module__list-flex___DE65m"},r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__date-span___8yRl2"},o(e.start_dt).format("ll"),r.createElement("br",null),c===e.id&&r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__positive-note___TNVKv"},"(",r.createElement(d.vN,null,"this event"),")")),r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__event-title___961dm"},e.title,r.createElement("br",null),r.createElement(ce.TooltipIfTruncated,null,r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__detail___mXZyy"},e.category_chain?e.category_chain.join(" » "):r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__warning-reason___ag6NQ"},r.createElement(d.vN,null,"Unlisted"))))),(c!==e.id||N)&&r.createElement(T.Z,{trigger:r.createElement(P.Z,{className:"events-management-client-js-___SeriesManagement-module__delete-button___BZmEH",name:"close",onClick:()=>{a(),i(),n(t.filter((t=>t.id!==e.id)))},link:!0}),content:d.vN.string("Remove from event series"),position:"bottom center"}))))))))}he.propTypes={eventId:c().number.isRequired,categoryId:c().number.isRequired,timezone:c().string.isRequired,seriesId:c().number},he.defaultProps={seriesId:null},fe.propTypes={currentEventId:c().number.isRequired,categoryId:c().number.isRequired,series:c().shape({id:c().number,events:c().arrayOf(c().object).isRequired,show_sequence_in_title:c().bool.isRequired,show_links:c().bool.isRequired,event_title_pattern:c().string.isRequired}).isRequired,timezone:c().string.isRequired,onClose:c().func.isRequired},be.propTypes={value:c().arrayOf(c().object).isRequired,onChange:c().func.isRequired,divider:c().node.isRequired,localMoment:c().func.isRequired,categoryId:c().number.isRequired,currentEventId:c().number.isRequired,existingSeriesId:c().number,onFocus:c().func.isRequired,onBlur:c().func.isRequired},be.defaultProps={existingSeriesId:null},function(e){function t(){$("#person-filters ul > li").removeClass("enabled");const e=$(".js-event-person-list tr[data-person-roles]"),t=$(".js-event-person-list [data-filter]:checked").map((function(){const e=$(this);return e.closest("li").addClass("enabled"),e.data("filter")})).get(),n=e.filter(((e,n)=>!t.length||t.find((e=>$(n).data("person-roles")[e]))));e.addClass("hidden"),n.removeClass("hidden"),$(".js-event-person-list").trigger("indico:syncEnableIfChecked")}function n(){$(".js-reset-role-filter").toggleClass("disabled",0===$("#person-filters [data-filter]:checked").length)}function i(){$(".js-show-regforms").qtip({content:{text(){return $(this).data("title")}},hide:{delay:100,fixed:!0}})}e.setupEmailButton=function(e,t){const n=document.querySelector(e),{eventId:i,roleId:s,personSelector:l}=n.dataset,c={};void 0!==n.dataset.noAccount&&(c.noAccount=!0),void 0!==n.dataset.notInvitedOnly&&(c.notInvitedOnly=!0),o.render(r.createElement(q,(0,a.Z)({eventId:+i,roleId:s&&+s,personSelector:l,triggerSelector:t},c)),n)},e.setupEmailContribAbstractRoles=function(e){const t=document.querySelector(e),{objectContext:n,idSelector:a,metadataUrl:i,previewUrl:s,sendUrl:l}=t.dataset;o.render(r.createElement(Y.X,{objectContext:n,idSelector:a,metadataURL:i,previewURL:s,sendURL:l,className:"js-requires-selected-row disabled"}),t)},e.setupAuthorsListButton=function(e){const t=document.querySelector(e),{eventId:n,objectContext:a,paramsSelector:i}=t.dataset;o.render(r.createElement(W,{eventId:+n,objectContext:a,paramsSelector:i}),t)},e.setupEventManagementActionMenu=function(){const e=document.querySelector("#event-action-move-container");e&&o.render(r.createElement(te.BN,{eventId:+e.dataset.eventId,currentCategoryId:+e.dataset.categoryId,hasPendingMoveRequest:void 0!==e.dataset.pendingRequest}),e);const t=document.querySelector("#event-action-manage-series-container");if(t){const e=void 0!==t.dataset.seriesId?+t.dataset.seriesId:null;o.render(r.createElement(he,{eventId:+t.dataset.eventId,categoryId:+t.dataset.categoryId,timezone:t.dataset.timezone,seriesId:e}),t)}const n=document.querySelector("#event-action-publish-container");n&&o.render(r.createElement(te.CT,{eventId:+n.dataset.eventId,hasPendingPublishRequest:void 0!==n.dataset.pendingRequest}),n),$("#event-action-menu-clones-target").qbubble({content:{text:$("#event-action-menu-clones")}}),$("#event-action-menu-actions-target").qbubble({content:{text:$("#event-action-menu-actions")},style:{classes:"qtip-allow-overflow"}});$(["#event-action-menu-actions button:not(.js-dropdown)","#event-action-menu-actions a:not(.disabled)"].join(", ")).on("click",(function(){$("#event-action-menu-actions-target").qbubble("hide")}))},e.setupEventPersonsList=function(e){e=$.extend({hasNoAccountFilter:!1,hasNoRegistrationFilter:!1,hasNoBuiltinRolesFilter:!1},e);const a=setupSearchBox({itemHandle:"tr",listItems:"#event-participants-list tbody tr:not(.hidden)",term:"#search-input",state:"#filtering-state",placeholder:"#filter-placeholder"});enableIfChecked(".js-event-person-list",".select-row:visible",".js-event-person-list .js-requires-selected-row"),$(".js-event-person-list").closest(".ui-dialog").length&&$(".js-event-person-list [data-toggle=dropdown]").closest(".toolbar").dropdown(),$(".js-event-person-list [data-filter]").on("click",t),$(".js-event-person-list td").on("mouseenter",(function(){const e=$(this);this.offsetWidth<this.scrollWidth&&!e.attr("title")&&e.attr("title",e.text())})),$(".js-event-person-list .tablesorter").tablesorter({cssAsc:"header-sort-asc",cssDesc:"header-sort-desc",headerTemplate:"",sortList:[[1,0]]});const r=$(".js-event-person-list .roles-column > span");r.qbubble({show:{event:"mouseover"},hide:{fixed:!0,delay:100,event:"mouseleave"},position:{my:"left center",at:"right center"},content:{text(){const e=$(this),t=$("<div>"),n=$("<strong>",{text:$(this).data("role-name")});if(t.append(n),e.is(".js-count-label")){const n=$("<ul>",{class:"qbubble-item-list"}),a=s()(e.data("items")).sort((function(e,t){return(0,ee.U)(e.title.toLowerCase(),t.title.toLowerCase())}));$.each(a,(function(){const e=$("<li>");this.url?e.append($("<a>",{text:this.title,href:this.url})):e.text(this.title),n.append(e)})),t.append(n)}return t}}}),r.filter(".custom").each((function(){const e=$(this);e.css("background-color",$.Color(e.css("color")).alpha(.1))})),e.hasNoAccountFilter&&($(".js-event-person-list [data-filter]:not(#filter-no-account)").on("change",(function(){$("#filter-no-account").prop("checked",!1),t(),a()})),$("#filter-no-account").on("change",(function(){this.checked&&$(".js-event-person-list [data-filter]:checked:not(#filter-no-account)").prop("checked",!1),t(),a()}))),e.hasNoRegistrationFilter&&($(".js-event-person-list [data-filter]:not(#filter-no-registration)").on("change",(function(){$("#filter-no-registration").prop("checked",!1),t(),a()})),$("#filter-no-registration").on("change",(function(){this.checked&&$(".js-event-person-list [data-filter]:checked:not(#filter-no-registration)").prop("checked",!1),t(),a()}))),e.hasNoBuiltinRolesFilter&&($(".js-event-person-list [data-filter]:not(#filter-no-builtin-roles)").on("change",(function(){$("#filter-no-builtin-roles").prop("checked",!1),t(),a()})),$("#filter-no-builtin-roles").on("change",(function(){this.checked&&$(".js-event-person-list [data-filter]:checked:not(#filter-no-builtin-roles)").prop("checked",!1),t(),a()}))),i();const o=$("#person-filters");o.find("li .colored-square").each((function(){const e=$(this);e.closest("li").css("background-color",$.Color(e.css("color")).alpha(.1))})),o.find(".js-reset-role-filter").on("click",(function(){$(".js-event-person-list [data-filter]").each((function(){const e=$(this);e.prop("checked",!1),e.parent().toggleClass("enabled",!1)})),t(),a(),n()})),o.find("li label").on("click",(function(e){e.preventDefault()})),o.find("li").on("click",(function(){const e=$(this).find("[data-filter]");e.prop("checked",!e.prop("checked")).trigger("change"),n()})),$("#event-participants-list").on("indico:htmlUpdated",i)},e.showUndoWarning=function(e,t,n){cornerMessage({message:e,progressMessage:J.$T.gettext("Undoing previous operation..."),feedbackMessage:t,actionLabel:J.$T.gettext("Undo"),actionCallback:n,duration:1e4,feedbackDuration:4e3,class:"warning"})},e.handleSelectedRowHighlight=function(e){const t=$("table.i-table input.select-row").on("change",(function(){$(this).closest("tr").toggleClass("selected",this.checked)}));e&&t.trigger("change")},e.showThemeSettingsForm=function(e){e=$.extend(!0,{formUrl:null,themeFieldId:null,lastFieldId:null},e),$(`#${e.themeFieldId}`).on("change",(function(){$.ajax({url:e.formUrl,data:{theme:$(this).val()},complete:IndicoUI.Dialogs.Util.progress(),error:handleAjaxError,success(t){const n=$(`#${e.lastFieldId}`);n.nextAll(":not(.form-group-footer)").remove(),t.html&&n.after(t.html),t.js&&$("body").append(t.js)}})}))}}(window)}},e=>{e.O(0,[5514,3044,8592],(()=>{return t=60958,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=module_events.management.c31106ac.bundle.js.map
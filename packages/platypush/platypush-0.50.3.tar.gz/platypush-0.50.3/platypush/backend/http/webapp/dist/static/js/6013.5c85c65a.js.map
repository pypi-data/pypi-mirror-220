{"version":3,"file":"static/js/6013.5c85c65a.js","mappings":"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","sources":["webpack://platypush/./src/components/widgets/Music/Index.vue","webpack://platypush/./src/components/widgets/Music/Index.vue?d0a3"],"sourcesContent":["<template>\n  <Loading v-if=\"loading\" />\n  <div class=\"music\" v-else>\n    <div class=\"track\">\n      <div class=\"unknown\" v-if=\"!status\">[Unknown state]</div>\n      <div class=\"no-track\" v-if=\"status && status.state === 'stop'\">No media is being played</div>\n      <div class=\"artist\" v-if=\"status && status.state !== 'stop' && track && track.artist\" v-text=\"track.artist\"></div>\n      <div class=\"title\" v-if=\"status && status.state !== 'stop' && track && track.title\" v-text=\"track.title\"></div>\n    </div>\n\n    <div class=\"time\"  v-if=\"status && status.state === 'play'\">\n      <div class=\"row\">\n        <div class=\"progress-bar\">\n          <div class=\"elapsed\" :style=\"{width: track.time ? 100*(status.elapsed/track.time) + '%' : '100%'}\"></div>\n          <div class=\"total\"></div>\n        </div>\n      </div>\n\n      <div class=\"row\">\n        <div class=\"col-6 time-elapsed\" v-text=\"convertTime(status.elapsed)\"></div>\n        <div class=\"col-6 time-total\" v-if=\"track.time\" v-text=\"convertTime(track.time)\"></div>\n      </div>\n    </div>\n\n    <div class=\"controls\" v-if=\"_withControls && status\">\n      <button @click=\"prev\">\n        <i class=\"fa fa-step-backward\" />\n      </button>\n      <button class=\"play-pause\" @click=\"playPause\">\n        <i class=\"fa fa-pause\" v-if=\"status.state === 'play'\" />\n        <i class=\"fa fa-play\" v-else />\n      </button>\n      <button @click=\"stop\" v-if=\"status.state !== 'stop'\">\n        <i class=\"fa fa-stop\" />\n      </button>\n      <button @click=\"next\">\n        <i class=\"fa fa-step-forward\" />\n      </button>\n    </div>\n\n    <div class=\"playback-status\" v-if=\"status\">\n      <div class=\"status-property col-4\">\n        <i class=\"fa fa-volume-up\"></i>&nbsp; <span v-text=\"status.volume + '%'\"></span>\n      </div>\n\n      <div class=\"status-property col-2\">\n        <i class=\"fas fa-random\" :class=\"{active: status.random}\"></i>\n      </div>\n      <div class=\"status-property col-2\">\n        <i class=\"fas fa-redo\" :class=\"{active: status.repeat}\"></i>\n      </div>\n      <div class=\"status-property col-2\">\n        <i class=\"fa fa-bullseye\" :class=\"{active: status.single}\"></i>\n      </div>\n      <div class=\"status-property col-2\">\n        <i class=\"fa fa-utensils\" :class=\"{active: status.consume}\"></i>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Utils from \"@/Utils\";\nimport Loading from \"@/components/Loading\";\n\nexport default {\n  name: \"Music\",\n  components: {Loading},\n  mixins: [Utils],\n  props: {\n    // Refresh interval in seconds.\n    refreshSeconds: {\n      type: Number,\n      default: 60,\n    },\n\n    // Set to true if you also want to include music controls in the widget.\n    withControls: {\n      type: Boolean,\n      default: true,\n    }\n  },\n\n  data() {\n    return {\n      track: undefined,\n      status: undefined,\n      timer: undefined,\n      loading: false,\n      musicPlugin: 'music.mpd',\n\n      syncTime: {\n        timestamp: null,\n        elapsed: null,\n      },\n    }\n  },\n\n  computed: {\n    _withControls() {\n      return this.parseBoolean(this.withControls)\n    },\n  },\n\n  methods: {\n    async refresh() {\n      this.loading = true\n\n      try {\n        let status = await this.request(`${this.musicPlugin}.status`)\n        let track = await this.request(`${this.musicPlugin}.current_track`)\n\n        this._parseStatus(status)\n        this._parseTrack(track)\n\n        if (status.state === 'play' && !this.timer)\n          this.startTimer()\n        else if (status.state !== 'play' && this.timer)\n          this.stopTimer()\n      } finally {\n        this.loading = false\n      }\n    },\n\n    convertTime(time) {\n      time = parseFloat(time)   // Normalize strings\n      const t = {}\n      t.h = parseInt(time/3600)\n      t.m = parseInt(time/60 - t.h*60)\n      t.s = parseInt(time - (t.h*3600 + t.m*60))\n\n      for (const attr of ['m','s']) {\n        t[attr] = '' + t[attr]\n      }\n\n      for (const attr of ['m','s']) {\n        if (parseInt(t[attr]) < 10) {\n          t[attr] = '0' + t[attr]\n        }\n      }\n\n      const ret = []\n      if (parseInt(t.h)) {\n        ret.push(t.h)\n      }\n\n      ret.push(t.m, t.s)\n      return ret.join(':')\n    },\n\n    async _parseStatus(status) {\n      if (!status || status.length === 0)\n        status = await this.request(`${this.musicPlugin}.status`)\n      if (status?.pluginName)\n        this.musicPlugin = status.pluginName\n      if (!this.status)\n        this.status = {}\n\n      for (const [attr, value] of Object.entries(status)) {\n        if (['consume','random','repeat','single','bitrate'].indexOf(attr) >= 0) {\n          this.status[attr] = !!parseInt(value)\n        } else if (['nextsong','nextsongid','playlist','playlistlength',\n          'volume','xfade','song','songid'].indexOf(attr) >= 0) {\n          this.status[attr] = parseInt(value)\n        } else if (['elapsed'].indexOf(attr) >= 0) {\n          this.status[attr] = parseFloat(value)\n        } else {\n          this.status[attr] = value\n        }\n      }\n    },\n\n    async _parseTrack(track) {\n      if (!track || track.length === 0) {\n        track = await this.request(`${this.musicPlugin}.current_track`)\n      }\n\n      if (!this.track)\n        this.track = {}\n\n      for (const [attr, value] of Object.entries(track)) {\n        if (['id','pos','time','track','disc'].indexOf(attr) >= 0) {\n          this.track[attr] = parseInt(value)\n        } else {\n          this.track[attr] = value\n        }\n      }\n    },\n\n    showNewTrackNotification() {\n      this.notify({\n        html: '<b>' + (this.track.artist || '[No Artist]') + '</b><br>' +\n            (this.track.title || '[No Title]'),\n        image: {\n          icon: 'play',\n        }\n      })\n    },\n\n    async onNewPlayingTrack(event) {\n      let previousTrack = undefined\n\n      if (this.track) {\n        previousTrack = {\n          file: this.track.file,\n          artist: this.track.artist,\n          title: this.track.title,\n        }\n      }\n\n      this.status.state = 'play'\n      this.status.elapsed = 0\n      this.track = {}\n      this._parseTrack(event.track)\n\n      let status = event.status ? event.status : await this.request(`${this.musicPlugin}.status`)\n      this._parseStatus(status)\n      this.startTimer()\n\n      if (!previousTrack || (this.track.file !== previousTrack.file\n          || this.track.artist !== previousTrack.artist\n          || this.track.title !== previousTrack.title)) {\n        this.showNewTrackNotification()\n      }\n    },\n\n    onMusicStop(event) {\n      this.status.state = 'stop'\n      this.status.elapsed = 0\n      this._parseStatus(event.status)\n      this._parseTrack(event.track)\n      this.stopTimer()\n    },\n\n    onMusicPlay(event) {\n      this.status.state = 'play'\n      this._parseStatus(event.status)\n      this._parseTrack(event.track)\n      this.startTimer()\n    },\n\n    onMusicPause(event) {\n      this.status.state = 'pause'\n      this._parseStatus(event.status)\n      this._parseTrack(event.track)\n\n      this.syncTime.timestamp = new Date()\n      this.syncTime.elapsed = this.status.elapsed\n    },\n\n    onSeekChange(event) {\n      if (event.position != null)\n        this.status.elapsed = parseFloat(event.position)\n      if (event.status)\n        this._parseStatus(event.status)\n      if (event.track)\n        this._parseTrack(event.track)\n\n      this.syncTime.timestamp = new Date()\n      this.syncTime.elapsed = this.status.elapsed\n    },\n\n    onVolumeChange(event) {\n      if (event.volume != null)\n        this.status.volume = parseFloat(event.volume)\n      if (event.status)\n        this._parseStatus(event.status)\n      if (event.track)\n        this._parseTrack(event.track)\n    },\n\n    onRepeatChange(event) {\n      this.status.repeat = event.state\n    },\n\n    onRandomChange(event) {\n      this.status.random = event.state\n    },\n\n    onConsumeChange(event) {\n      this.status.consume = event.state\n    },\n\n    onSingleChange(event) {\n      this.status.single = event.state\n    },\n\n    startTimer() {\n      if (this.timer != null) {\n        this.stopTimer()\n      }\n\n      this.syncTime.timestamp = new Date()\n      this.syncTime.elapsed = this.status.elapsed\n      this.timer = setInterval(this.timerFunc, 1000)\n    },\n\n    stopTimer() {\n      if (this.timer == null) {\n        clearInterval(this.timer)\n        this.timer = null\n      }\n    },\n\n    timerFunc() {\n      if (this.status.state !== 'play' || this.status.elapsed == null) {\n        return\n      }\n\n      this.status.elapsed = this.syncTime.elapsed +\n          ((new Date()).getTime()/1000) - (this.syncTime.timestamp.getTime()/1000)\n    },\n\n    async _run(action, args) {\n      args = args || {}\n      await this.request(`music.mpd.${action}`, args)\n      await this.refresh()\n    },\n\n    async playPause() {\n      return await this._run('pause')\n    },\n\n    async stop() {\n      return await this._run('stop')\n    },\n\n    async prev() {\n      return await this._run('previous')\n    },\n\n    async next() {\n      return await this._run('next')\n    },\n  },\n\n  mounted() {\n    this.refresh()\n    if (this.refreshSeconds) {\n      setInterval(this.refresh, parseInt((this.refreshSeconds*1000).toFixed(0)))\n    }\n\n    this.subscribe(this.onNewPlayingTrack, 'widget-music-on-new-track', 'platypush.message.event.music.NewPlayingTrackEvent')\n    this.subscribe(this.onMusicStop, 'widget-music-on-music-stop', 'platypush.message.event.music.MusicStopEvent')\n    this.subscribe(this.onMusicPlay, 'widget-music-on-music-play', 'platypush.message.event.music.MusicPlayEvent')\n    this.subscribe(this.onMusicPause, 'widget-music-on-music-pause', 'platypush.message.event.music.MusicPauseEvent')\n    this.subscribe(this.onSeekChange, 'widget-music-on-music-seek', 'platypush.message.event.music.SeekChangeEvent')\n    this.subscribe(this.onVolumeChange, 'widget-music-on-volume-change', 'platypush.message.event.music.VolumeChangeEvent')\n    this.subscribe(this.onRepeatChange, 'widget-music-on-repeat-change', 'platypush.message.event.music.PlaybackRepeatModeChangeEvent')\n    this.subscribe(this.onRandomChange, 'widget-music-on-random-change', 'platypush.message.event.music.PlaybackRandomModeChangeEvent')\n    this.subscribe(this.onConsumeChange, 'widget-music-on-consume-change', 'platypush.message.event.music.PlaybackConsumeModeChangeEvent')\n    this.subscribe(this.onSingleChange, 'widget-music-on-single-change', 'platypush.message.event.music.PlaybackSingleModeChangeEvent')\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n$progress-bar-bg: #ddd;\n$playback-status-color: #757f70;\n\n.music {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n\n  .track {\n    text-align: center;\n\n    .unknown,\n    .no-track {\n      font-size: 2em;\n    }\n\n    .artist {\n      font-size: 1.9em;\n      font-weight: bold;\n      margin-bottom: .25em;\n    }\n\n    .title {\n      font-size: 1.8em;\n      font-weight: normal;\n    }\n  }\n\n  .time {\n    width: 100%;\n    margin-top: 1em;\n    font-size: 1.2em;\n\n    .row {\n      padding: 0 .5em;\n    }\n\n    .time-total {\n      text-align: right;\n    }\n\n    .progress-bar {\n      width: 100%;\n      height: 1em;\n      position: relative;\n      margin-bottom: .75em;\n\n      .total {\n        position: absolute;\n        width: 100%;\n        height: 100%;\n        top: 0;\n        background: $progress-bar-bg;\n        border-radius: 0.5em;\n      }\n\n      .elapsed {\n        position: absolute;\n        width: 100%;\n        height: 100%;\n        top: 0;\n        background: $selected-bg;\n        border-radius: 0.5em;\n        z-index: 1;\n      }\n    }\n  }\n\n  .playback-status {\n    position: absolute;\n    bottom: 0;\n    border-top: $default-border-2;\n    color: $playback-status-color;\n    width: 100%;\n    height: 2em;\n\n    .status-property {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      height: 100%;\n    }\n\n    .active {\n      color: $default-hover-fg;\n    }\n  }\n\n  .controls {\n    margin-top: .5em;\n    font-size: 1.2em;\n\n    button {\n      background: none;\n      border: none;\n\n      &:hover {\n        color: $default-hover-fg;\n      }\n\n      &.play-pause {\n        color: $selected-fg;\n        font-size: 1.5em;\n      }\n    }\n  }\n}\n</style>\n","import { render } from \"./Index.vue?vue&type=template&id=75982eb8&scoped=true\"\nimport script from \"./Index.vue?vue&type=script&lang=js\"\nexport * from \"./Index.vue?vue&type=script&lang=js\"\n\nimport \"./Index.vue?vue&type=style&index=0&id=75982eb8&lang=scss&scoped=true\"\n\nimport exportComponent from \"/home/blacklight/git_tree/platypush/platypush/backend/http/webapp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-75982eb8\"]])\n\nexport default __exports__"],"names":["class","loading","status","state","track","artist","title","style","time","elapsed","_withControls","prev","playPause","stop","next","volume","random","repeat","single","consume","name","components","Loading","mixins","Utils","props","refreshSeconds","type","Number","default","withControls","Boolean","data","undefined","timer","musicPlugin","syncTime","timestamp","computed","this","parseBoolean","methods","async","request","_parseStatus","_parseTrack","stopTimer","startTimer","convertTime","parseFloat","t","h","parseInt","m","s","attr","ret","push","join","length","pluginName","value","Object","entries","indexOf","showNewTrackNotification","notify","html","image","icon","event","previousTrack","file","onMusicStop","onMusicPlay","onMusicPause","Date","onSeekChange","position","onVolumeChange","onRepeatChange","onRandomChange","onConsumeChange","onSingleChange","setInterval","timerFunc","clearInterval","getTime","action","args","refresh","_run","mounted","toFixed","subscribe","onNewPlayingTrack","__exports__","render"],"sourceRoot":""}
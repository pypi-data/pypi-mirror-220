"use strict";(self["webpackChunkplatypush"]=self["webpackChunkplatypush"]||[]).push([[8448],{634:function(e,t,n){n.d(t,{N:function(){return l}});var i=n(9584);n(1703);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}n(7941),n(6977),n(1249),n(2222),n(7042),n(9600),n(1539),n(9714);var l=function(){function e(t){if(o(this,e),this.ranges={hue:[0,360],sat:[0,100],bri:[0,100],ct:[154,500]},t)for(var n=0,i=Object.keys(this.ranges);n<i.length;n++){var r=i[n];t[r]&&(this.ranges[r]=t[r])}}return a(e,[{key:"normalize",value:function(e,t,n){return n[0]+(e-t[0])*(n[1]-n[0])/(t[1]-t[0])}},{key:"hslToRgb",value:function(e,t,n){var i=[this.normalize(e,this.ranges.hue,[0,360]),this.normalize(t,this.ranges.sat,[0,100]),this.normalize(n,this.ranges.bri,[0,100])];e=i[0],t=i[1],n=i[2],n/=100;var o=t*Math.min(n,1-n)/100,r=function(t){var i=(t+e/30)%12,r=n-o*Math.max(Math.min(i-3,9-i,1),-1);return Math.round(255*r)};return[r(0),r(8),r(4)]}},{key:"rgbToHsl",value:function(e,t,n){e/=255,t/=255,n/=255;var i,o,r=Math.max(e,t,n),a=Math.min(e,t,n),l=(r+a)/2;if(r===a)i=o=0;else{var s=r-a;switch(o=l>.5?s/(2-r-a):s/(r+a),r){case e:i=(t-n)/s+(t<n?6:0);break;case t:i=(n-e)/s+2;break;case n:i=(e-t)/s+4;break}i/=6}return[parseInt(this.normalize(i,[0,1],this.ranges.hue)),parseInt(this.normalize(o,[0,1],this.ranges.sat)),parseInt(this.normalize(l,[0,1],this.ranges.bri))]}},{key:"xyToRgb",value:function(e,t,n){null==n&&(n=this.ranges.bri[1]);var i=1-e-t,o=(n/(this.ranges.bri[1]-1)).toFixed(2),r=o/t*e,a=o/t*i,l=1.656492*r-.354851*o-.255038*a,s=.707196*-r+1.655397*o+.036152*a,u=.051713*r-.121364*o+1.01153*a;return l>u&&l>s&&l>1?(s/=l,u/=l,l=1):s>u&&s>l&&s>1?(l/=s,u/=s,s=1):u>l&&u>s&&u>1&&(l/=u,s/=u,u=1),l=l<=.0031308?12.92*l:1.055*Math.pow(l,1/2.4)-.055,s=s<=.0031308?12.92*s:1.055*Math.pow(s,1/2.4)-.055,u=u<=.0031308?12.92*u:1.055*Math.pow(u,1/2.4)-.055,l=Math.round(255*l),s=Math.round(255*s),u=Math.round(255*u),isNaN(l)&&(l=0),isNaN(s)&&(s=0),isNaN(u)&&(u=0),[l,s,u].map((function(e){return Math.min(Math.max(0,e),255)}))}},{key:"rgbToXY",value:function(e,t,n){e>1&&(e/=255),t>1&&(t/=255),n>1&&(n/=255),e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92;var i=.664511*e+.154324*t+.162028*n,o=.283881*e+.668433*t+.047685*n,r=88e-6*e+.07231*t+.986039*n,a=parseFloat((i/(i+o+r)).toFixed(4)),l=parseFloat((o/(i+o+r)).toFixed(4));return isNaN(a)&&(a=0),isNaN(l)&&(l=0),[a,l]}},{key:"rgbToBri",value:function(e,t,n){return Math.min(2*this.rgbToHsl(e,t,n)[2],this.ranges.bri[1])}},{key:"getRGB",value:function(e){return null!=e.red&&null!=e.green&&null!=e.blue?[e.red,e.green,e.blue]:null!=e.r&&null!=e.g&&null!=e.b?[e.r,e.g,e.b]:e.rgb?e.rgb:void 0}},{key:"getXY",value:function(e){return null!=e.x&&null!=e.y?[e.x,e.y]:e.xy?e.xy:void 0}},{key:"toRGB",value:function(e){var t=this.getRGB(e);if(t)return t;var n=this.getXY(e);return n&&e.bri?this.xyToRgb.apply(this,(0,i.Z)(n).concat([e.bri])):e.hue&&e.sat&&e.bri?this.hslToRgb(e.hue,e.sat,e.bri):(console.debug("Could not determine color space"),void console.debug(e))}},{key:"toXY",value:function(e){var t=this.getXY(e);if(t&&e.bri)return[t[0],t[1],e.bri];var n=this.getRGB(e);if(n)return this.rgbToXY.apply(this,(0,i.Z)(n));if(e.hue&&e.sat&&e.bri){var o=this.hslToRgb(e.hue,e.sat,e.bri);return this.rgbToXY.apply(this,(0,i.Z)(o))}console.debug("Could not determine color space"),console.debug(e)}},{key:"toHSL",value:function(e){if(e.hue&&e.sat&&e.bri)return[e.hue,e.sat,e.bri];var t=this.getRGB(e);if(t)return this.rgbToHsl.apply(this,(0,i.Z)(t));var n=this.getXY(e);if(n&&e.bri){var o=this.xyToRgb.apply(this,(0,i.Z)(n).concat([e.bri]));return this.rgbToHsl.apply(this,(0,i.Z)(o))}console.debug("Could not determine color space"),console.debug(e)}},{key:"hexToRgb",value:function(e){return[e.slice(1,3),e.slice(3,5),e.slice(5,7)].map((function(e){return parseInt(e,16)}))}},{key:"rgbToHex",value:function(e){return"#"+e.map((function(e){var t=e.toString(16);return t.length<2&&(t="0"+t),t})).join("")}}]),e}()},8816:function(e,t,n){n.d(t,{Z:function(){return y}});var i=n(6252),o=n(3577),r=n(9963),a={class:"slider-wrapper"},l=["textContent"],s=["textContent"],u={class:"slider-container"},c=["min","max","step","disabled","value"],g={class:"track-inner",ref:"track"},d={class:"thumb",ref:"thumb"},p=["textContent"];function h(e,t,n,h,v,f){return(0,i.wg)(),(0,i.iD)("label",a,[n.withRange?((0,i.wg)(),(0,i.iD)("span",{key:0,class:(0,o.C_)(["range-labels",{"with-label":n.withLabel}])},[n.withRange?((0,i.wg)(),(0,i.iD)("span",{key:0,class:"label left",textContent:(0,o.zw)(n.range[0])},null,8,l)):(0,i.kq)("",!0),n.withRange?((0,i.wg)(),(0,i.iD)("span",{key:1,class:"label right",textContent:(0,o.zw)(n.range[1])},null,8,s)):(0,i.kq)("",!0)],2)):(0,i.kq)("",!0),(0,i._)("span",u,[(0,i._)("input",{class:(0,o.C_)(["slider",{"with-label":n.withLabel}]),type:"range",min:n.range[0],max:n.range[1],step:n.step,disabled:n.disabled,value:n.value,ref:"range",onInput:t[0]||(t[0]=(0,r.iM)((function(){return f.onUpdate&&f.onUpdate.apply(f,arguments)}),["stop"])),onChange:t[1]||(t[1]=(0,r.iM)((function(){return f.onUpdate&&f.onUpdate.apply(f,arguments)}),["stop"]))},null,42,c),(0,i._)("div",{class:(0,o.C_)(["track",{"with-label":n.withLabel}])},[(0,i._)("div",g,null,512)],2),(0,i._)("div",d,null,512),n.withLabel?((0,i.wg)(),(0,i.iD)("span",{key:0,class:"label",textContent:(0,o.zw)(n.value),ref:"label"},null,8,p)):(0,i.kq)("",!0)])])}var v=n(4648),f=(n(9653),{name:"Slider",emits:["input","change","mouseup","mousedown","touchstart","touchend","keyup","keydown"],props:{value:{type:Number},disabled:{type:Boolean,default:!1},range:{type:Array,default:function(){return[0,100]}},step:{type:Number,default:1},withLabel:{type:Boolean,default:!1},withRange:{type:Boolean,default:!1}},methods:{onUpdate:function(e){this.update(e.target.value),this.$emit(e.type,(0,v.Z)((0,v.Z)({},e),{},{target:(0,v.Z)((0,v.Z)({},e.target),{},{value:this.$refs.range.value})}))},update:function(e){var t=this.$refs.range.clientWidth,n=(e-this.range[0])/(this.range[1]-this.range[0]),i=n*t,o=this.$refs.thumb;o.style.left="".concat(i-o.clientWidth/2,"px"),this.$refs.thumb.style.transform="translate(-".concat(n,"%, -50%)"),this.$refs.track.style.width="".concat(i,"px")}},mounted:function(){var e=this;null!=this.value&&this.update(this.value),this.$watch((function(){return e.value}),(function(t){return e.update(t)}))}}),m=n(3744);const b=(0,m.Z)(f,[["render",h],["__scopeId","data-v-4b38623f"]]);var y=b},6:function(e,t,n){n.d(t,{Z:function(){return h}});var i=n(6252),o=n(3577),r=n(9963),a=function(e){return(0,i.dD)("data-v-a6396ae8"),e=e(),(0,i.Cn)(),e},l=["checked"],s=a((function(){return(0,i._)("div",{class:"switch"},[(0,i._)("div",{class:"dot"})],-1)})),u={class:"label"};function c(e,t,n,a,c,g){return(0,i.wg)(),(0,i.iD)("div",{class:(0,o.C_)(["power-switch",{disabled:n.disabled}]),onClick:t[0]||(t[0]=(0,r.iM)((function(){return g.onInput&&g.onInput.apply(g,arguments)}),["stop"]))},[(0,i._)("input",{type:"checkbox",checked:n.value},null,8,l),(0,i._)("label",null,[s,(0,i._)("span",u,[(0,i.WI)(e.$slots,"default",{},void 0,!0)])])],2)}var g={name:"ToggleSwitch",emits:["input"],props:{value:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},methods:{onInput:function(e){if(this.disabled)return!1;this.$emit("input",e)}}},d=n(3744);const p=(0,d.Z)(g,[["render",c],["__scopeId","data-v-a6396ae8"]]);var h=p},8448:function(e,t,n){n.r(t),n.d(t,{default:function(){return Ut}});n(7941);var i=n(6252),o={class:"plugin lights-plugin"},r={key:0,class:"panel"},a={key:1,class:"panel"};function l(e,t,n,l,s,u){var c=(0,i.up)("Groups"),g=(0,i.up)("Group");return(0,i.wg)(),(0,i.iD)("div",o,[null==s.selectedGroup&&n.groups&&Object.keys(n.groups).length?((0,i.wg)(),(0,i.iD)("div",r,[(0,i.Wm)(c,{groups:n.groups,"loading-groups":n.loadingGroups,"color-converter":n.colorConverter,onSelect:t[0]||(t[0]=function(e){return s.selectedGroup=e}),onToggle:t[1]||(t[1]=function(t){return e.$emit("group-toggle",t)})},null,8,["groups","loading-groups","color-converter"])])):((0,i.wg)(),(0,i.iD)("div",a,[(0,i.Wm)(g,{group:n.groups[s.selectedGroup],lights:u.displayedLights,scenes:u.scenesByGroup[s.selectedGroup],"color-converter":n.colorConverter,animations:u.animationsByGroup[s.selectedGroup],onClose:t[2]||(t[2]=function(e){return s.selectedGroup=null}),onLightToggle:t[3]||(t[3]=function(t){return e.$emit("light-toggle",t)}),onGroupToggle:t[4]||(t[4]=function(t){return e.$emit("group-toggle",t)}),onSetLight:t[5]||(t[5]=function(t){return e.$emit("set-light",t)}),onSetGroup:t[6]||(t[6]=function(t){return e.$emit("set-group",{groupId:s.selectedGroup,value:t})}),onSelectScene:t[7]||(t[7]=function(t){return e.$emit("select-scene",{groupId:s.selectedGroup,sceneId:t})}),onStartAnimation:t[8]||(t[8]=function(t){return e.$emit("start-animation",t)}),onStopAnimation:t[9]||(t[9]=function(t){return e.$emit("stop-animation",t)})},null,8,["group","lights","scenes","color-converter","animations"])]))])}var s=n(4648),u=n(6084),c=(n(9653),n(1539),n(9720),n(4747),n(2479),n(6813)),g={name:"Panel",emits:["mounted"],props:{config:{type:Object,default:function(){}},pluginName:{type:String,required:!0}},data:function(){return{loading:!1}},mounted:function(){this.$emit("mounted",this)}};const d=g;var p=d,h=(n(8309),n(3577)),v=function(e){return(0,i.dD)("data-v-42318a2b"),e=e(),(0,i.Cn)(),e},f={class:"panel-row header"},m=v((function(){return(0,i._)("div",{class:"col-3"},[(0,i._)("i",{class:"icon fas fa-home"})],-1)})),b=v((function(){return(0,i._)("div",{class:"col-6 name"}," Rooms ",-1)})),y={class:"col-3 pull-right"},_=["onClick"],w={class:"name col-9"},k={class:"controls col-3 pull-right"};function C(e,t,n,o,r,a){var l=(0,i.up)("ToggleSwitch"),s=(0,i.up)("MenuPanel");return(0,i.wg)(),(0,i.j4)(s,null,{default:(0,i.w5)((function(){return[(0,i._)("div",f,[m,b,(0,i._)("div",y,[(0,i.Wm)(l,{value:a.anyLightsOn,onInput:t[0]||(t[0]=function(t){return e.$emit("toggle")})},null,8,["value"])])]),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.groupsSorted,(function(t){return(0,i.wg)(),(0,i.iD)("div",{class:"panel-row row group",key:t.id,onClick:function(n){return e.$emit("select",t.id)}},[(0,i._)("span",w,(0,h.zw)(t.name||"[Group ".concat(t.id,"]")),1),(0,i._)("span",k,[(0,i.Wm)(l,{value:t.state.any_on,disabled:t.id in(n.loadingGroups||{}),onInput:function(n){return e.$emit("toggle",t)}},null,8,["value","disabled","onInput"])])],8,_)})),128))]})),_:1})}n(1249),n(2707);var S={class:"menu-panel"},j={class:"content"};function Z(e,t,n,o,r,a){return(0,i.wg)(),(0,i.iD)("div",S,[(0,i._)("div",j,[(0,i.WI)(e.$slots,"default")])])}var O={name:"MenuPanel"},L=n(3744);const D=(0,L.Z)(O,[["render",Z]]);var M=D,x=n(6),G=n(634),$={name:"Groups",components:{ToggleSwitch:x.Z,MenuPanel:M},emits:["select","toggle"],props:{groups:{type:Object,default:function(){}},loadingGroups:{type:Object,default:function(){}},colorConverter:{type:Object,default:function(){return new G.N}}},computed:{groupsSorted:function(){return Object.entries(this.groups).sort((function(e,t){return e[1].name.localeCompare(t[1].name)})).map((function(e){var t=(0,u.Z)(e,2),n=t[0],i=t[1];return(0,s.Z)((0,s.Z)({},i),{},{id:n})}))},anyLightsOn:function(){for(var e=0,t=Object.values(this.groups);e<t.length;e++){var n,i=t[e];if(null!==i&&void 0!==i&&null!==(n=i.state)&&void 0!==n&&n.any_on)return!0}return!1}}};const I=(0,L.Z)($,[["render",C],["__scopeId","data-v-42318a2b"]]);var T=I,A={class:"light-group-container"},B={class:"panel-row header"},N={key:0,class:"col-3"},R=(0,i._)("i",{class:"fas fa-chevron-left"},null,-1),U=[R],W=["textContent"],q={key:1,class:"col-3 pull-right"},z={key:0,class:"no-lights"},H={key:1,class:"lights-view"},V={class:"row view-selector"},Y=(0,i._)("i",{class:"icon fas fa-lightbulb"},null,-1),F=[Y],P=(0,i._)("i",{class:"icon far fa-image"},null,-1),X=[P],E=(0,i._)("i",{class:"icon fas fa-video"},null,-1),K=[E],J={key:0,class:"view fade-in"},Q=["onClick"],ee={key:1,class:"view fade-in"},te=["onClick"],ne={key:2,class:"view group-controls fade-in"},ie={key:3,class:"view group-controls fade-in"};function oe(e,t,n,o,r,a){var l=(0,i.up)("ToggleSwitch"),s=(0,i.up)("Light"),u=(0,i.up)("Scene"),c=(0,i.up)("Controls"),g=(0,i.up)("Animate"),d=(0,i.up)("MenuPanel");return(0,i.wg)(),(0,i.iD)("div",A,[(0,i.Wm)(d,null,{default:(0,i.w5)((function(){return[(0,i._)("div",B,[n.group?((0,i.wg)(),(0,i.iD)("div",N,[(0,i._)("button",{class:"back-btn",title:"Back",onClick:t[0]||(t[0]=function(){return a.close&&a.close.apply(a,arguments)})},U)])):(0,i.kq)("",!0),(0,i._)("div",{class:(0,h.C_)(["col-6 name",{selected:"group"===r.selectedView}]),textContent:(0,h.zw)(a.groupName),onClick:t[1]||(t[1]=function(e){return r.selectedView="group"===r.selectedView?null:"group"})},null,10,W),n.group?((0,i.wg)(),(0,i.iD)("div",q,[(0,i.Wm)(l,{value:n.group.state.any_on,onInput:t[2]||(t[2]=function(t){return e.$emit("group-toggle",n.group)})},null,8,["value"])])):(0,i.kq)("",!0)]),n.lights&&Object.keys(n.lights).length?((0,i.wg)(),(0,i.iD)("div",H,[(0,i._)("div",V,[(0,i._)("button",{class:(0,h.C_)({selected:"lights"===r.selectedView}),title:"Lights",onClick:t[3]||(t[3]=function(e){return r.selectedView="lights"})},F,2),(0,i._)("button",{class:(0,h.C_)({selected:"scenes"===r.selectedView}),title:"Scenes",onClick:t[4]||(t[4]=function(e){return r.selectedView="scenes"})},X,2),(0,i._)("button",{class:(0,h.C_)({selected:"animate"===r.selectedView}),title:"Animate",onClick:t[5]||(t[5]=function(e){return r.selectedView="animate"})},K,2)]),"lights"===r.selectedView?((0,i.wg)(),(0,i.iD)("div",J,[((0,i.wg)(),(0,i.j4)(i.Ob,null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.lightsSorted,(function(t,o){return(0,i.wg)(),(0,i.iD)("div",{class:(0,h.C_)(["panel-row row",{expanded:t.id===r.selectedLight}]),key:o,onClick:function(e){return r.selectedLight=r.selectedLight===t.id?null:t.id}},[(0,i.Wm)(s,{light:t,group:n.group,collapsed:t.id!==r.selectedLight,"color-converter":n.colorConverter,onToggle:function(n){return e.$emit("light-toggle",t)},onSetLight:function(n){return e.$emit("set-light",{light:t,value:n})}},null,8,["light","group","collapsed","color-converter","onToggle","onSetLight"])],10,Q)})),128))],1024))])):"scenes"===r.selectedView?((0,i.wg)(),(0,i.iD)("div",ee,[((0,i.wg)(),(0,i.j4)(i.Ob,null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.scenesSorted,(function(e,t){return(0,i.wg)(),(0,i.iD)("div",{class:(0,h.C_)(["panel-row row",{selected:e.id===r.selectedScene}]),key:t,onClick:function(t){return a.onSceneSelected(e.id)}},[(0,i.Wm)(u,{scene:e,group:n.group},null,8,["scene","group"])],10,te)})),128))],1024))])):"group"===r.selectedView?((0,i.wg)(),(0,i.iD)("div",ne,[((0,i.wg)(),(0,i.j4)(i.Ob,null,[(0,i.Wm)(c,{group:n.group,lights:n.lights,"color-converter":n.colorConverter,onSetGroup:t[6]||(t[6]=function(t){return e.$emit("set-group",t)})},null,8,["group","lights","color-converter"])],1024))])):"animate"===r.selectedView?((0,i.wg)(),(0,i.iD)("div",ie,[((0,i.wg)(),(0,i.j4)(i.Ob,null,[(0,i.Wm)(g,{group:n.group,lights:n.lights,"color-converter":n.colorConverter,"running-animations":n.animations,onStart:t[7]||(t[7]=function(t){return e.$emit("start-animation",t)}),onStop:t[8]||(t[8]=function(t){return e.$emit("stop-animation",t)})},null,8,["group","lights","color-converter","running-animations"])],1024))])):(0,i.kq)("",!0)])):((0,i.wg)(),(0,i.iD)("div",z," No lights found "))]})),_:1})])}var re={class:"row"},ae={class:"toggle col-3 pull-right"},le={key:0,class:"row fade-in"};function se(e,t,n,o,r,a){var l=(0,i.up)("ToggleSwitch"),s=(0,i.up)("Controls");return(0,i.wg)(),(0,i.iD)("div",{class:(0,h.C_)(["light",{expanded:!n.collapsed}]),ref:"element"},[(0,i._)("div",re,[(0,i._)("span",{class:"name col-9",onClick:t[0]||(t[0]=function(){return a.expandToggle&&a.expandToggle.apply(a,arguments)})},(0,h.zw)(n.light.name||"[Light ".concat(n.light.id,"]")),1),(0,i._)("span",ae,[(0,i.Wm)(l,{value:n.light.state.on,disabled:n.loading,onInput:t[1]||(t[1]=function(t){return e.$emit("toggle",n.light)})},null,8,["value","disabled"])])]),n.collapsed?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",le,[(0,i.Wm)(s,{light:n.light,loading:n.loading,"color-converter":n.colorConverter,onSetLight:t[2]||(t[2]=function(t){return e.$emit("set-light",t)})},null,8,["light","loading","color-converter"])]))],2)}var ue=n(9963),ce=function(e){return(0,i.dD)("data-v-e2726892"),e=e(),(0,i.Cn)(),e},ge={key:1,class:"row"},de=ce((function(){return(0,i._)("div",{class:"col-1 icon"},[(0,i._)("i",{class:"fas fa-sun"})],-1)})),pe={class:"col-11 control"},he={key:2,class:"row"},ve=ce((function(){return(0,i._)("div",{class:"col-1 icon"},[(0,i._)("i",{class:"fas fa-thermometer-half"})],-1)})),fe={class:"col-11 control"},me={key:3,class:"row"},be=ce((function(){return(0,i._)("span",{class:"col-1 icon"},[(0,i._)("i",{class:"fas fa-palette"})],-1)})),ye={class:"col-11 control"},_e=["value"];function we(e,t,n,o,r,a){var l=(0,i.up)("Loading"),s=(0,i.up)("Slider");return(0,i.wg)(),(0,i.iD)("div",{class:"controls light-controls",onClick:t[3]||(t[3]=function(e){return e.stopPropagation()})},[n.loading?((0,i.wg)(),(0,i.j4)(l,{key:0})):(0,i.kq)("",!0),null!=a.state.bri?((0,i.wg)(),(0,i.iD)("div",ge,[de,(0,i._)("div",pe,[(0,i.Wm)(s,{range:n.colorConverter.ranges.bri,disabled:n.loading,value:a.state.bri,onMouseup:t[0]||(t[0]=(0,ue.iM)((function(t){return e.$emit(n.light?"set-light":"set-group",{brightness:parseInt(t.target.value)})}),["stop"]))},null,8,["range","disabled","value"])])])):(0,i.kq)("",!0),null!=a.state.ct?((0,i.wg)(),(0,i.iD)("div",he,[ve,(0,i._)("div",fe,[(0,i.Wm)(s,{range:n.colorConverter.ranges.ct,disabled:n.loading,value:a.state.ct,onMouseup:t[1]||(t[1]=(0,ue.iM)((function(t){return e.$emit(n.light?"set-light":"set-group",{temperature:parseInt(t.target.value)})}),["stop"]))},null,8,["range","disabled","value"])])])):(0,i.kq)("",!0),a.rgbColor?((0,i.wg)(),(0,i.iD)("label",me,[be,(0,i._)("span",ye,[(0,i._)("input",{type:"color",value:a.rgbColor,onChange:t[2]||(t[2]=(0,ue.iM)((function(){return a.onColorSelect&&a.onColorSelect.apply(a,arguments)}),["stop"]))},null,40,_e)])])):(0,i.kq)("",!0)])}var ke=n(9584),Ce=(n(3948),n(2222),n(9600),n(9714),n(4916),n(3123),n(7042),n(8816)),Se=n(1232),je={name:"Controls",components:{Loading:Se.Z,Slider:Ce.Z},emits:["set-light","set-group"],props:{light:{type:Object},lights:{type:Object},group:{type:Object},loading:{type:Boolean,default:!1},colorConverter:{type:Object,default:function(){return new G.N}}},computed:{state:function(){var e,t;if(null!==(e=this.light)&&void 0!==e&&e.state)return this.light.state;var n=(null===(t=this.group)||void 0===t?void 0:t.state)||{};if(!this.lights)return n;var i=function e(t){return t&&t.length?t[0]instanceof Array?(0,ke.Z)(t[0].keys()).map((function(n){return e(t.map((function(e){return e[n]})))})):t.reduce((function(e,t){return e+t}),0)/t.length:0};return(0,s.Z)((0,s.Z)({},n),Object.entries(Object.values(this.lights).reduce((function(e,t){return["bri","hue","sat","rgb","xy","red","green","blue","ct"].forEach((function(n){var i;null!=(null===(i=t.state)||void 0===i?void 0:i[n])&&(e[n]=[].concat((0,ke.Z)(e[n]||[]),[t.state[n]]))})),e}),{})).reduce((function(e,t){var n=(0,u.Z)(t,2),o=n[0],r=n[1];return e[o]=i(r),e}),{}))},color:function(){return this.getColor(this.state)},rgbColor:function(){var e=this.colorConverter.toRGB(this.state);return e?"#"+e.map((function(e){var t=e.toString(16);return t.length<2&&(t="0"+t),t})).join(""):null}},methods:{onColorSelect:function(e){var t,n,i,o=e.target.value.slice(1).split(/(?=(?:..)*$)/).map((function(e){return parseInt("0x".concat(e))}));this.$emit(this.light?"set-light":"set-group",{rgb:o,xy:(t=this.colorConverter).rgbToXY.apply(t,(0,ke.Z)(o)),hsl:(n=this.colorConverter).rgbToHsl.apply(n,(0,ke.Z)(o)),brightness:(i=this.colorConverter).rgbToBri.apply(i,(0,ke.Z)(o))})},getColor:function(e){return{rgb:this.colorConverter.toRGB(e),xy:this.colorConverter.toXY(e),hsl:this.colorConverter.toHSL(e)}}}};const Ze=(0,L.Z)(je,[["render",we],["__scopeId","data-v-e2726892"]]);var Oe=Ze,Le={name:"Light",components:{Controls:Oe,ToggleSwitch:x.Z},emits:["toggle","set-light","collapsed","expanded"],props:{light:{type:Object,default:function(){}},group:{type:Object,default:function(){}},loading:{type:Boolean,default:!1},collapsed:{type:Boolean,default:!0},colorConverter:{type:Object,default:function(){return new G.N}}},methods:{expandToggle:function(){this.$emit(this.collapsed?"expanded":"collapsed")}}};const De=(0,L.Z)(Le,[["render",se],["__scopeId","data-v-52168252"]]);var Me=De;function xe(e,t,n,o,r,a){var l=(0,i.up)("Loading");return(0,i.wg)(),(0,i.iD)(i.HY,null,[n.loading?((0,i.wg)(),(0,i.j4)(l,{key:0})):(0,i.kq)("",!0),(0,i._)("div",{class:"scene row name",onClick:t[0]||(t[0]=function(){return a.onSelect&&a.onSelect.apply(a,arguments)})},(0,h.zw)(n.scene.name||"[Scene ".concat(n.scene.id,"]")),1)],64)}var Ge={name:"Light",emits:["select"],props:{scene:{type:Object,default:function(){}},group:{type:Object,default:function(){}},loading:{type:Boolean,default:!1}},methods:{onSelect:function(){if(this.loading)return!1;this.$emit("select")}}};const $e=(0,L.Z)(Ge,[["render",xe]]);var Ie=$e,Te=(n(7327),function(e){return(0,i.dD)("data-v-71cae6ae"),e=e(),(0,i.Cn)(),e}),Ae={class:"animation-container"},Be={class:"animation-header"},Ne={class:"row"},Re=Te((function(){return(0,i._)("div",{class:"col-3"}," Run Animation ",-1)})),Ue={class:"col-9"},We={class:"row"},qe=Te((function(){return(0,i._)("div",{class:"col-3"},"Animation",-1)})),ze={class:"col-9"},He=Te((function(){return(0,i._)("option",{value:"color_transition"},"Color transition",-1)})),Ve=Te((function(){return(0,i._)("option",{value:"blink"},"Blink",-1)})),Ye=[He,Ve],Fe={class:"animation"},Pe={key:0,class:"row"},Xe=Te((function(){return(0,i._)("div",{class:"col-3"}," Hue range ",-1)})),Ee={class:"col-9"},Ke={key:1,class:"row"},Je=Te((function(){return(0,i._)("div",{class:"col-3"}," Sat range ",-1)})),Qe={class:"col-9"},et={key:2,class:"row"},tt=Te((function(){return(0,i._)("div",{class:"col-3"}," Bri range ",-1)})),nt={class:"col-9"},it={key:3,class:"row"},ot=Te((function(){return(0,i._)("div",{class:"col-3"}," Hue step ",-1)})),rt={class:"col-9"},at={key:4,class:"row"},lt=Te((function(){return(0,i._)("div",{class:"col-3"}," Sat step ",-1)})),st={class:"col-9"},ut={key:5,class:"row"},ct=Te((function(){return(0,i._)("div",{class:"col-3"}," Bri step ",-1)})),gt={class:"col-9"},dt={class:"row"},pt=Te((function(){return(0,i._)("div",{class:"col-3"}," Refresh seconds ",-1)})),ht={class:"col-9"},vt=["value"],ft={class:"row"},mt=Te((function(){return(0,i._)("div",{class:"col-3"}," Duration (seconds) ",-1)})),bt={class:"col-9"},yt=["value"],_t={class:"lights"},wt={class:"row"},kt=["checked"],Ct=(0,i.Uk)(" Select all lights "),St=["onUpdate:modelValue","onInput"];function jt(e,t,n,o,r,a){var l=(0,i.up)("Loading"),s=(0,i.up)("ToggleSwitch"),u=(0,i.up)("RangeSlider"),c=(0,i.up)("Slider");return(0,i.wg)(),(0,i.iD)("div",{class:"controls animation-controls",onClick:t[10]||(t[10]=function(e){return e.stopPropagation()})},[n.loading?((0,i.wg)(),(0,i.j4)(l,{key:0})):(0,i.kq)("",!0),(0,i._)("div",Ae,[(0,i._)("div",Be,[(0,i._)("div",Ne,[Re,(0,i._)("div",Ue,[(0,i.Wm)(s,{value:a.animationRunning,onInput:a.toggleAnimation},null,8,["value","onInput"])])]),(0,i._)("div",We,[qe,(0,i._)("div",ze,[(0,i._)("label",null,[(0,i._)("select",{class:"selector",onClick:t[0]||(t[0]=function(e){return r.selectedAnimation=e.target.value})},Ye)])])])]),(0,i._)("div",Fe,["color_transition"===r.selectedAnimation?((0,i.wg)(),(0,i.iD)("div",Pe,[Xe,(0,i._)("div",Ee,[(0,i.Wm)(u,{range:n.colorConverter.ranges.hue,disabled:n.loading,value:r.animations.color_transition.hue_range,onMouseup:t[1]||(t[1]=function(e){return r.animations.color_transition.hue_range=e.target.value})},null,8,["range","disabled","value"])])])):(0,i.kq)("",!0),"color_transition"===r.selectedAnimation?((0,i.wg)(),(0,i.iD)("div",Ke,[Je,(0,i._)("div",Qe,[(0,i.Wm)(u,{range:n.colorConverter.ranges.sat,disabled:n.loading,value:r.animations.color_transition.sat_range,onMouseup:t[2]||(t[2]=function(e){return r.animations.color_transition.sat_range=e.target.value})},null,8,["range","disabled","value"])])])):(0,i.kq)("",!0),"color_transition"===r.selectedAnimation?((0,i.wg)(),(0,i.iD)("div",et,[tt,(0,i._)("div",nt,[(0,i.Wm)(u,{range:n.colorConverter.ranges.sat,disabled:n.loading,value:r.animations.color_transition.bri_range,onMouseup:t[3]||(t[3]=function(e){return r.animations.color_transition.bri_range=e.target.value})},null,8,["range","disabled","value"])])])):(0,i.kq)("",!0),"color_transition"===r.selectedAnimation?((0,i.wg)(),(0,i.iD)("div",it,[ot,(0,i._)("div",rt,[(0,i.Wm)(c,{range:n.colorConverter.ranges.hue,disabled:n.loading,value:r.animations.color_transition.hue_step,onMouseup:t[4]||(t[4]=function(e){return r.animations.color_transition.hue_step=parseFloat(e.target.value)})},null,8,["range","disabled","value"])])])):(0,i.kq)("",!0),"color_transition"===r.selectedAnimation?((0,i.wg)(),(0,i.iD)("div",at,[lt,(0,i._)("div",st,[(0,i.Wm)(c,{range:n.colorConverter.ranges.sat,disabled:n.loading,value:r.animations.color_transition.sat_step,onMouseup:t[5]||(t[5]=function(e){return r.animations.color_transition.sat_step=parseFloat(e.target.value)})},null,8,["range","disabled","value"])])])):(0,i.kq)("",!0),"color_transition"===r.selectedAnimation?((0,i.wg)(),(0,i.iD)("div",ut,[ct,(0,i._)("div",gt,[(0,i.Wm)(c,{range:n.colorConverter.ranges.bri,disabled:n.loading,value:r.animations.color_transition.bri_step,onMouseup:t[6]||(t[6]=function(e){return r.animations.color_transition.bri_step=parseFloat(e.target.value)})},null,8,["range","disabled","value"])])])):(0,i.kq)("",!0),(0,i._)("div",dt,[pt,(0,i._)("div",ht,[(0,i._)("label",null,[(0,i._)("input",{type:"number",value:r.animations[r.selectedAnimation].transition_seconds,step:"0.1",onInput:t[7]||(t[7]=function(e){return r.animations[r.selectedAnimation].transition_seconds=parseFloat(e.target.value)})},null,40,vt)])])]),(0,i._)("div",ft,[mt,(0,i._)("div",bt,[(0,i._)("label",null,[(0,i._)("input",{type:"number",value:r.animations[r.selectedAnimation].duration,step:"5",onInput:t[8]||(t[8]=function(e){var t;return r.animations[r.selectedAnimation].duration=null!==(t=e.target.value)&&void 0!==t&&t.length?parseFloat(e.target.value):null})},null,40,yt)])])])])]),(0,i._)("div",_t,[(0,i._)("div",wt,[(0,i._)("label",null,[(0,i._)("input",{type:"checkbox",checked:Object.keys(n.lights).length===Object.values(r.selectedLights).filter((function(e){return e})).length,onClick:t[9]||(t[9]=function(){return a.toggleSelectAll&&a.toggleSelectAll.apply(a,arguments)})},null,8,kt),Ct])]),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.lights,(function(e,t){return(0,i.wg)(),(0,i.iD)("div",{class:"row",key:t},[(0,i._)("label",null,[(0,i.wy)((0,i._)("input",{type:"checkbox","onUpdate:modelValue":function(e){return r.selectedLights[t]=e},onInput:function(e){return r.selectedLights[t]=!r.selectedLights[t]}},null,40,St),[[ue.e8,r.selectedLights[t]]]),(0,i.Uk)(" "+(0,h.zw)(e.name),1)])])})),128))])])}var Zt={class:"range-wrapper"},Ot=["value","min","max","step","disabled"];function Lt(e,t,n,o,r,a){return(0,i.wg)(),(0,i.iD)("div",Zt,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.value,(function(e,o){return(0,i.wg)(),(0,i.iD)("input",{class:"slider",type:"range",value:e,min:n.range[0],max:n.range[1],step:n.step,disabled:n.disabled,ref_for:!0,ref:"ranges",onInput:t[0]||(t[0]=(0,ue.iM)((function(){return a.onUpdate&&a.onUpdate.apply(a,arguments)}),["stop"])),onChange:t[1]||(t[1]=(0,ue.iM)((function(){return a.onUpdate&&a.onUpdate.apply(a,arguments)}),["stop"])),onMouseup:t[2]||(t[2]=(0,ue.iM)((function(){return a.onUpdate&&a.onUpdate.apply(a,arguments)}),["stop"])),onMousedown:t[3]||(t[3]=(0,ue.iM)((function(){return a.onUpdate&&a.onUpdate.apply(a,arguments)}),["stop"])),onTouchstart:t[4]||(t[4]=(0,ue.iM)((function(){return a.onUpdate&&a.onUpdate.apply(a,arguments)}),["stop"])),onTouchend:t[5]||(t[5]=(0,ue.iM)((function(){return a.onUpdate&&a.onUpdate.apply(a,arguments)}),["stop"])),onKeyup:t[6]||(t[6]=(0,ue.iM)((function(){return a.onUpdate&&a.onUpdate.apply(a,arguments)}),["stop"])),onKeydown:t[7]||(t[7]=(0,ue.iM)((function(){return a.onUpdate&&a.onUpdate.apply(a,arguments)}),["stop"])),key:o},null,40,Ot)})),128))])}var Dt={name:"RangeSlider",emits:["input","change","mouseup","mousedown","touchstart","touchend","keyup","keydown"],props:{disabled:{type:Boolean,default:!1},range:{type:Array,default:function(){return[0,100]}},step:{type:Number,default:1},value:{type:Array,default:function(){return[0,100]}}},methods:{onUpdate:function(e){this.$emit(e.type,(0,s.Z)((0,s.Z)({},e),{},{target:(0,s.Z)((0,s.Z)({},e.target),{},{value:this.$refs.ranges.map((function(e){return parseFloat(e.value)})).sort()})}))}}};const Mt=(0,L.Z)(Dt,[["render",Lt],["__scopeId","data-v-981c5de0"]]);var xt=Mt,Gt={name:"Animate",mixins:[c.Z],components:{ToggleSwitch:x.Z,Slider:Ce.Z,RangeSlider:xt,Loading:Se.Z},emits:["start","stop"],props:{lights:{type:Object},group:{type:Object},loading:{type:Boolean,default:!1},colorConverter:{type:Object,default:function(){return new G.N}},runningAnimations:{type:Object,default:function(){}}},data:function(){return{selectedAnimation:"color_transition",animation:{},selectedLights:Object.keys(this.lights).reduce((function(e,t){return e[t]=!0,e}),{}),animations:{color_transition:{hue_range:this.colorConverter.ranges.hue,sat_range:[parseInt((this.colorConverter.ranges.sat[1]-this.colorConverter.ranges.sat[0])/2),this.colorConverter.ranges.sat[1]],bri_range:[parseInt(.75*(this.colorConverter.ranges.bri[1]-this.colorConverter.ranges.bri[0])),this.colorConverter.ranges.bri[1]],hue_step:parseInt((this.colorConverter.ranges.hue[1]-this.colorConverter.ranges.hue[0])/25),sat_step:parseInt((this.colorConverter.ranges.sat[1]-this.colorConverter.ranges.sat[0])/50),bri_step:parseInt((this.colorConverter.ranges.bri[1]-this.colorConverter.ranges.bri[0])/50),transition_seconds:1,duration:null},blink:{transition_seconds:1,duration:null}}}},computed:{animationRunning:function(){return Object.keys(this.runningAnimations).length>0}},methods:{toggleSelectAll:function(){var e=this,t=Object.values(this.selectedLights).filter((function(e){return e})).length<Object.keys(this.lights).length;Object.keys(this.lights).forEach((function(n){e.selectedLights[n]=t}))},toggleAnimation:function(){var e=this.animationRunning?"stop":"start",t=Object.entries(this.selectedLights).filter((function(e){return e[1]})).map((function(e){return e[0]}));t.length?this.$emit(e,{lights:t,animation:(0,s.Z)((0,s.Z)({},this.animations[this.selectedAnimation]),{},{animation:this.selectedAnimation})}):this.notifyWarning("No lights have been selected")}}};const $t=(0,L.Z)(Gt,[["render",jt],["__scopeId","data-v-71cae6ae"]]);var It=$t,Tt={name:"Group",emits:["close","group-toggle","light-toggle","set-light","select-scene","start-animation","stop-animation"],components:{Animate:It,ToggleSwitch:x.Z,MenuPanel:M,Light:Me,Scene:Ie,Controls:Oe},props:{lights:{type:Object},group:{type:Object},scenes:{type:Object},animations:{type:Object,default:function(){}},colorConverter:{type:Object,default:function(){return new G.N}}},data:function(){return{selectedLight:null,selectedScene:null,selectedView:"lights"}},computed:{lightsSorted:function(){return this.lights?Object.entries(this.lights).sort((function(e,t){return e[1].name.localeCompare(t[1].name)})).map((function(e){var t=(0,u.Z)(e,2),n=t[0],i=t[1];return(0,s.Z)((0,s.Z)({},i),{},{id:n})})):[]},scenesSorted:function(){return this.scenes?Object.entries(this.scenes).sort((function(e,t){return e[1].name.localeCompare(t[1].name)})).map((function(e){var t=(0,u.Z)(e,2),n=t[0],i=t[1];return(0,s.Z)((0,s.Z)({},i),{},{id:n})})):[]},groupName:function(){var e,t;return null!==(e=this.group)&&void 0!==e&&e.name?this.group.name:null!=(null===(t=this.group)||void 0===t?void 0:t.id)?"[Group ".concat(this.group.id,"]"):"Lights"}},methods:{close:function(e){e.stopPropagation(),this.$emit("close")},onSceneSelected:function(e){this.selectedScene=e,this.$emit("select-scene",e)}}};const At=(0,L.Z)(Tt,[["render",oe]]);var Bt=At,Nt={name:"Light",components:{Group:Bt,Groups:T},mixins:[c.Z,p],emits:["group-toggle","light-toggle","set-light","set-group","select-scene","start-animation","stop-animation","refresh","light-changed"],props:{lights:{type:Object},groups:{type:Object},scenes:{type:Object},animations:{type:Object},colorConverter:{type:Object,default:function(){return new G.N}},loadingLights:{type:Object,default:function(){}},loadingGroups:{type:Object,default:function(){}},pluginName:{type:String},initialGroup:{type:[Number,String]}},data:function(){return{selectedGroup:null,initialized:!1}},computed:{displayedLights:function(){var e=this,t=this.selectedGroup||this.initialGroup;return null==t?this.lights:this.groups[t].lights.reduce((function(t,n){return t[n]=e.lights[n],t}),{})},groupsByLight:function(){return this.groups?Object.entries(this.groups).reduce((function(e,t){var n=(0,u.Z)(t,2),i=n[0],o=n[1];return o.lights.forEach((function(t){e[t]||(e[t]={}),e[t][i]=o})),e}),{}):{}},scenesByGroup:function(){if(!this.scenes)return{};var e=this;return Object.entries(this.scenes).reduce((function(t,n){var i=(0,u.Z)(n,2),o=i[0],r=i[1];return r.lights.forEach((function(n){Object.keys(e.groupsByLight[n]).forEach((function(e){t[e]||(t[e]={}),t[e][o]=r}))})),t}),{})},animationsByGroup:function(){var e,t,n=this,i=Object.entries((null===(e=this.animations)||void 0===e?void 0:e.groups)||{}).reduce((function(e,t){var n=(0,u.Z)(t,2),i=n[0],o=n[1];return e[i]={},o&&(e[i][null]=o),e}),{});return(0,s.Z)((0,s.Z)({},i),Object.entries((null===(t=this.animations)||void 0===t?void 0:t.lights)||{}).reduce((function(e,t){var i,o=(0,u.Z)(t,2),r=o[0],a=o[1],l=null===(i=Object.values(n.groupsByLight[r]))||void 0===i?void 0:i[0];return l&&a&&null!=l.id&&(e[l.id]||(e[l.id]={}),e[l.id][r]=a),e}),{}))}},methods:{initSelectedGroup:function(){var e=this,t=this.$watch((function(){return e.initialGroup}),(function(n){e.initialized||(e.initialized=!0,t(),null==e.selectedGroup&&null!=n&&(e.selectedGroup=e.initialGroup))}))},refresh:function(){this.$emit("refresh")},onLightChange:function(e){if(e.plugin_name===this.pluginName)if(this.lights[e.light_id]){var t=(0,s.Z)({},e),n=t.light_id;delete t.light_id,delete t.type,delete t.plugin_name,this.$emit("light-changed",{id:n,state:t})}else this.refresh()},onAnimationChange:function(e){e.plugin_name===this.pluginName&&this.refresh()}},mounted:function(){this.subscribe(this.onLightChange,"on-light-change","platypush.message.event.light.LightStatusChangeEvent"),this.subscribe(this.onAnimationChange,"on-animation-change","platypush.message.event.light.LightAnimationStartedEvent","platypush.message.event.light.LightAnimationStoppedEvent"),this.initSelectedGroup()},unmounted:function(){this.unsubscribe("on-light-change"),this.unsubscribe("on-animation-change")}};const Rt=(0,L.Z)(Nt,[["render",l],["__scopeId","data-v-781dd72c"]]);var Ut=Rt}}]);
//# sourceMappingURL=8448-legacy.fd3bc403.js.map
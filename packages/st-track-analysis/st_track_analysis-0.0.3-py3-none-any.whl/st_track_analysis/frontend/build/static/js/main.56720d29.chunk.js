(this.webpackJsonpstreamlit_component_template=this.webpackJsonpstreamlit_component_template||[]).push([[0],{196:function(e,t,a){},203:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(46),i=a.n(c),o=a(96),s=a(9),l=a(19),d=(a(196),a(25)),u=new Map([[0,"green"],[1,"purple"],[4,"red"],[18,"cyan"],[34,"pink"]]),j=["Pedestrian","Bicycle","Light vehicle","Heavy vehicle","Unknown"];function b(e,t,a,n,r,c){var i,o=new Map,l=Object(d.a)(e);try{for(l.s();!(i=l.n()).done;){var u=Object(s.a)(i.value,5),b=u[0],h=u[1],m=u[2],g=u[3],f=u[4];if(a.onlyConfirmed&&1===f||-1===t.indexOf(j[g]));else if(o.has(b)){var O=o.get(b),x=Object(s.a)(O,5),p=x[0],k=x[1],v=(x[2],x[3],x[4]);p.push(20*h+280),k.push(20*m+300),v.push(f)}else o.set(b,[[20*h+280],[20*m+300],g,b,[f]])}}catch(y){l.e(y)}finally{l.f()}return o.forEach((function(e,t){n&&(e[0].length<r||e[0].length>c)&&o.delete(t)})),Array.from(o.values(),(function(e){return function(e,t,a){var n=Object(s.a)(e,5),r=n[0],c=n[1],i=n[2],o=n[3],l=n[4],d=[r[0],c[0],0],u=[r[r.length-1],c[c.length-1],0],j=r.map((function(e,n){var i=l[n],o="L ".concat(e," ").concat(c[n]);if((t&&0===i||a&&1===i&&0!==n)&&0!==n){var s=0===i?6:3,d=[r[n-1],c[n-1]],u=d[0],j=d[1],b=[e,c[n]],h=b[0],m=b[1],g=Math.sqrt(Math.pow(h-u,2)+Math.pow(m-j,2)),f=[(j-m)/g,(h-u)/g],O=.707,x=f[0]*O-f[1]*O,p=f[0]*O+f[1]*O;o+="L ".concat(e+x*s," ").concat(c[n]+p*s," L ").concat(e," ").concat(c[n]," L ").concat(e-p*s," ").concat(c[n]+x*s," L ").concat(e," ").concat(c[n])}return o})).join(" ");return["M ".concat(r[0]," ").concat(c[0]," ").concat(j),i,o,d,u]}(e,a.markMeasurements,a.markEstimated)}))}var h=a(2),m=function(e){var t=e.WIDTH,a=e.HEIGHT,n=e.scale,r=e.pathStrings,c=e.showId,i=e.selectedIndices,o=e.vertices;return Object(h.jsxs)("svg",{width:t*n,height:a*n,style:{transform:"scale(".concat(n,")"),transformOrigin:"top left"},children:[r.map((function(e,t){var a=u.get(e[1]);return i.has(t)?Object(h.jsx)(h.Fragment,{}):Object(h.jsxs)("g",{children:[Object(h.jsx)("path",{d:e[0],stroke:a||"black",fill:"none"}),Object(h.jsx)("circle",{cx:e[3][0],cy:e[3][1],r:4,fill:"green",strokeWidth:"4"}),Object(h.jsx)("circle",{cx:e[4][0],cy:e[4][1],r:4,fill:"red",strokeWidth:"4"}),c&&Object(h.jsx)("text",{x:e[4][0],y:e[4][1],fill:"white",fontFamily:"sans-serif",fontSize:10,children:e[2]})]},e[0])})),o]})},g=a(139),f=a.n(g),O=a(268),x=a(270),p=a(292),k=a(307),v=a(308),y=a(273),w=a(309),C=a(310),L=a(311),M=a(294),S=function(e){e.label;var t,a=e.image,r=e.WIDTH,c=e.HEIGHT,i=e.tracks,o=e.from,d=e.to,u=e.showType,j=e.filterLength,g=e.minLength,S=e.maxLength,T=Object(n.useState)(1),I=Object(s.a)(T,2),D=I[0],F=I[1],H=Object(n.useState)({markMeasurements:!1,markEstimated:!1,onlyConfirmed:!1,trackId:!1,showLines:!1}),E=Object(s.a)(H,2),N=E[0],R=E[1],W=Object(n.useState)(new Map),Y=Object(s.a)(W,2),B=Y[0],P=Y[1],A=Object(n.useMemo)((function(){return b(i.slice(o,d),u,N,j,g,S)}),[o,d,u,N,j,g,S]),G=Object(h.jsx)(m,{WIDTH:r,HEIGHT:c,scale:D,pathStrings:A,showId:N.trackId,selectedIndices:B,vertices:[]});return Object(h.jsxs)("div",{children:[Object(h.jsx)("div",{className:"control-container",children:Object(h.jsx)(p.a,{value:D,"aria-label":"Default",valueLabelDisplay:"auto",onChange:function(e,t){"number"===typeof t&&F(t)},min:0,max:10,step:.01,color:"primary",className:"slider",style:{width:300,margin:0}})}),Object(h.jsxs)("div",{style:{overflow:"hidden",display:"flex"},children:[Object(h.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(h.jsx)(f.a,{children:Object(h.jsx)("div",{className:"image-container",style:{width:r*D,height:c*D,backgroundImage:"url(".concat(a,")")},children:G})}),Object(h.jsx)("div",{style:{marginTop:10},children:Object(h.jsxs)(k.a,{sx:{width:"100%",maxWidth:360,bgcolor:"background.paper",position:"relative",overflow:"auto",maxHeight:400,"& ul":{padding:0},borderRadius:1},subheader:Object(h.jsx)(v.a,{children:"Tracks"}),component:"nav","aria-label":"main mailbox folders",children:[Object(h.jsx)(y.a,{}),(t=A,t.map((function(e,t){return Object(h.jsxs)(O.a,{selected:B.has(t),onClick:function(e){B.has(t)?P((function(e){return e.delete(t),new Map(e)})):function(e,t){P((function(e){return new Map(e.set(t,!0))}))}(0,t)},children:[Object(h.jsx)(x.a,{primary:e[2]}),Object(h.jsx)(x.a,{primary:e[1]})]},t)})))]})})]}),Object(h.jsx)(w.a,{sx:{margin:0,marginLeft:2},component:"fieldset",variant:"standard",children:Object(h.jsxs)(C.a,{children:[Object(h.jsx)(L.a,{control:Object(h.jsx)(M.a,{checked:N.markMeasurements,onChange:function(e){R((function(t){return Object(l.a)(Object(l.a)({},t),{},{markMeasurements:e.target.checked})}))}}),label:"Mark measurments"}),Object(h.jsx)(L.a,{control:Object(h.jsx)(M.a,{checked:N.markEstimated,onChange:function(e){R((function(t){return Object(l.a)(Object(l.a)({},t),{},{markEstimated:e.target.checked})}))}}),label:"Mark estimated"}),Object(h.jsx)(L.a,{control:Object(h.jsx)(M.a,{checked:N.onlyConfirmed,onChange:function(e){R((function(t){return Object(l.a)(Object(l.a)({},t),{},{onlyConfirmed:e.target.checked})}))}}),label:"Show only confirmed"}),Object(h.jsx)(L.a,{control:Object(h.jsx)(M.a,{checked:N.trackId,onChange:function(e){R((function(t){return Object(l.a)(Object(l.a)({},t),{},{trackId:e.target.checked})}))}}),label:"Show track id"}),Object(h.jsx)(L.a,{control:Object(h.jsx)(M.a,{checked:N.showLines,onChange:function(e){R((function(t){return Object(l.a)(Object(l.a)({},t),{},{showLines:e.target.checked})}))}}),label:"Show lines"})]})})]})]})},T=a(29),I=a.n(T),D=a(95),F=a(299),H=a(300),E=a(290),N=a(302),R=a(305),W=a(301),Y=a(145),B=a(288),P=a(289),A=a(274),G=function(e){var t=e.date,a=e.setDate,n=e.fromTime,r=e.setFromTime,c=e.setToTime,i=e.interval,o=e.setDir,s=e.setInterval,l=e.showType,d=e.handleChange,u=e.filterLength,b=e.setFilterLength,m=e.minLength,g=e.setMinLength,f=e.maxLength,O=e.setMaxLength,p=e.handleBackwardClick,k=e.handleForwardClick,v={PaperProps:{style:{maxHeight:224,width:250}}};return console.log(l),Object(h.jsxs)("div",{children:[Object(h.jsxs)(Y.a,{dateAdapter:A.a,children:[Object(h.jsx)(B.a,{label:"Date",format:"YYYY-MM-DD",value:t,onChange:function(e){e&&a(e)},sx:{backgroundColor:"background.default",borderRadius:1,marginRight:2}}),Object(h.jsx)(P.a,{label:"From time",value:n,onChange:function(e){e&&(r(e),c(e.add(i,"minutes")),o(0))},ampm:!1,sx:{backgroundColor:"background.default",borderRadius:1,marginRight:2}})]}),Object(h.jsx)(F.a,{label:"Interval in minutes",id:"outlined-start-adornment",sx:{width:"25ch",backgroundColor:"background.default",borderRadius:1,margin:0,marginRight:2},value:i,onChange:function(e){var t=Number(e.target.value);isNaN(t)||(s(t),c(n.add(t,"minutes")))}}),Object(h.jsxs)(w.a,{sx:{m:1,width:300,margin:0},children:[Object(h.jsx)(H.a,{id:"demo-multiple-name-label",children:"Show types"}),Object(h.jsx)(E.a,{labelId:"demo-multiple-name-label",id:"demo-multiple-name",multiple:!0,value:l,onChange:d,input:Object(h.jsx)(N.a,{label:"Show types"}),renderValue:function(e){return e.join(", ")},MenuProps:v,sx:{backgroundColor:"background.default"},children:j.map((function(e){return Object(h.jsxs)(R.a,{value:e,children:[Object(h.jsx)(M.a,{checked:l.indexOf(e)>-1}),Object(h.jsx)(x.a,{primary:e})]},e)}))})]}),Object(h.jsx)("div",{children:Object(h.jsx)(L.a,{control:Object(h.jsx)(M.a,{checked:u,onChange:function(e){b(e.target.checked)}}),label:"Filter length",style:{margin:0,marginTop:10}})}),u&&Object(h.jsxs)("div",{style:{marginTop:10},children:[Object(h.jsx)(F.a,{label:"Minimum length",id:"outlined-start-adornment",sx:{m:1,width:"25ch",backgroundColor:"background.default",borderRadius:1,margin:0,marginRight:2},value:m,onChange:function(e){var t=Number(e.target.value);isNaN(t)||g(t)}}),Object(h.jsx)(F.a,{label:"Maximum length",id:"outlined-start-adornment",sx:{m:1,width:"25ch",backgroundColor:"background.default",borderRadius:1,margin:0,marginRight:2},value:f,onChange:function(e){var t=Number(e.target.value);isNaN(t)||O(t)}})]}),Object(h.jsxs)("div",{style:{margin:0,marginTop:10},children:[Object(h.jsx)(W.a,{sx:{marginRight:2,backgroundColor:"background.default"},onClick:function(){return p()},children:"<"}),Object(h.jsx)(W.a,{sx:{marginRight:2,backgroundColor:"background.default"},onClick:function(){return k()},children:">"})]})]})},V=function(){var e=Object(o.useRenderData)(),t=Object(n.useState)(0),a=Object(s.a)(t,2),c=a[0],i=a[1],l=Object(n.useState)(0),d=Object(s.a)(l,2),u=d[0],b=d[1],m=Object(n.useState)(0),g=Object(s.a)(m,2),f=g[0],O=g[1],x=Object(n.useState)(I()(e.args.date)),p=Object(s.a)(x,2),k=p[0],v=p[1],y=Object(n.useState)(I()(e.args.date)),w=Object(s.a)(y,2),C=w[0],L=w[1],M=Object(n.useState)(I()(e.args.date)),T=Object(s.a)(M,2),F=T[0],H=T[1],E=Object(n.useState)(1),N=Object(s.a)(E,2),R=N[0],W=N[1],Y=r.a.useState(j),B=Object(s.a)(Y,2),P=B[0],A=B[1],V=Object(n.useState)(!1),_=Object(s.a)(V,2),J=_[0],X=_[1],q=Object(n.useState)(0),z=Object(s.a)(q,2),U=z[0],K=z[1],Q=Object(n.useState)(0),Z=Object(s.a)(Q,2),$=Z[0],ee=Z[1],te=Object(n.useState)(e.args.tracks),ae=Object(s.a)(te,2),ne=ae[0],re=(ae[1],e.args.image),ce=e.args.height,ie=e.args.width;Object(n.useEffect)((function(){k.isValid()&&D.Streamlit.setComponentValue(k.format("YYYY-MM-DD"))}),[k]),Object(n.useEffect)((function(){!function(){var e,t;if(0===f)e=oe(C,0,ne.length-1),t=oe(F,0,ne.length-1);else if(1===f){var a=e=u+1;for(console.log("INDEX:",a,ne.length-1,a<ne.length-1);a<ne.length&&I()(ne[a][5]).isBefore(F);)a++;t=a}else{var n=t=c;for(console.log("INDEX:",n,ne.length);n>0&&n<ne.length&&C.isBefore(I()(ne[n][5]));)n--;e=n+1}i(e),b(t),console.log("First track:",ne[e]),console.log("Last track",ne[t-1]),console.log("From ".concat(e," to ").concat(t))}()}),[C,F]);function oe(e,t,a){for(;t<a;){var n=Math.floor(t+a>>>1);if(0===n)return 0;var r=I()(ne[n][5]);if(r.isAfter(e)&&I()(ne[n-1][5]).isBefore(e))return n;r.isAfter(e)?a=n:t=n+1}return t}var se=[Object(h.jsx)(S,{image:re,WIDTH:ie,HEIGHT:ce,tracks:ne,from:c,to:u,label:"Version 1",showType:P,filterLength:J,minLength:U,maxLength:$})];return Object(h.jsxs)("div",{style:{flexDirection:"column",marginTop:30},children:[Object(h.jsx)(G,{date:k,setDate:v,fromTime:C,setFromTime:L,setToTime:H,interval:R,setDir:O,setInterval:W,showType:P,handleChange:function(e){var t=e.target.value;A("string"===typeof t?t.split(","):t)},filterLength:J,setFilterLength:X,minLength:U,setMinLength:K,maxLength:$,setMaxLength:ee,handleBackwardClick:function(){L((function(e){return e.subtract(R,"minutes")})),H((function(e){return e.subtract(R,"minutes")})),O(-1)},handleForwardClick:function(){L((function(e){return e.add(R,"minutes")})),H((function(e){return e.add(R,"minutes")})),O(1)}}),Object(h.jsx)("div",{style:{display:"flex",flexDirection:"row"},children:Object(h.jsxs)("div",{style:{flexDirection:"row",flexWrap:"wrap"},children:[se.map((function(e){return e})),Object(h.jsx)("div",{style:{height:1e4}})]})})]})},_=a(150),J=a(296);console.warn=function(){};var X=Object(_.a)({palette:{primary:{main:"#F63366"},common:{black:"#F63366"},secondary:{main:"#F0F2F6"},text:{primary:"#fff",secondary:"#fff"},action:{active:"#fff"},background:{default:"#262730",paper:"#262730"}}});i.a.render(Object(h.jsx)(r.a.StrictMode,{children:Object(h.jsx)(o.StreamlitProvider,{children:Object(h.jsx)(J.a,{theme:X,children:Object(h.jsx)(V,{})})})}),document.getElementById("root"))}},[[203,1,2]]]);
//# sourceMappingURL=main.56720d29.chunk.js.map
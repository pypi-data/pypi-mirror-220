import{_ as q,L as A,s as G}from"./ListviewItem-2bd74fad.js";/* empty css                             */import{l as H,I as O,e as W,r as i,c as w,w as L,o as J,b as Q,q as v,y as h,j as s,x as n,L as k,F as x,z as S,v as g,M as b,A as X,N as _,k as Y,B as P,O as T,K as Z,W as z}from"./index-ade73b84.js";import{_ as ee}from"./PanelviewItem.vue_vue_type_style_index_0_lang-93dbfb68.js";import{C as te}from"./Container-282a676b.js";import{V as ae}from"./VSelect-a66ffc02.js";import{b as le,a as se}from"./VDialog-93a2100b.js";import{V as re,a as oe}from"./VRow-74a0e5a5.js";import{V as ue}from"./VToolbar-806969a3.js";import{V as ie}from"./VSpacer-159b0383.js";import{V as ne}from"./MediaItemThumb.vue_vue_type_style_index_0_lang-cd169f56.js";import{l as ve,k as me}from"./VBtn-61e39030.js";import"./VDivider-adefbf87.js";import"./VCard-f3e11b51.js";import"./VListItem-f848c028.js";import"./VMenu-ccc026f2.js";/* empty css              */const fe={key:2},ce={style:{"margin-left":"15px"}},xe=H({__name:"Search",props:{initSearch:{}},setup(N){const $=N,R=O(),{mobile:U}=W(),r=i("list"),V=i(0),o=i(""),m=i(!1),l=i(),y=i(!1),f=i(!1),c=i([]),C=i(),M=["topresult","artists","albums","tracks","playlists","radios"],D=w(()=>U.value?140:150),E=function(){r.value==="panel"?r.value="list":r.value="panel",localStorage.setItem(`viewMode.search.${u.value}`,r.value)},B=function(e){c.value=[e],f.value=!0},F=function(e){var t;["artist","album","playlist"].includes(e.media_type)||!((t=P.selectedPlayer)!=null&&t.available)?R.push({name:e.media_type,params:{itemId:e.item_id,provider:e.provider}}):P.selectedPlayer&&T.playMedia(e)};L(()=>o.value,()=>{clearTimeout(C.value),C.value=setTimeout(()=>{j()},200)});const K=function(e){return e<500?2:e<=500?3:e<=700?4:e<=1e3?5:e<=1200?6:e<=1500?7:e<=1700?8:e>1700?9:0},j=async function(){y.value=!0,localStorage.setItem("globalsearch",o.value),o.value?l.value=await T.search(o.value):l.value=void 0,y.value=!1},u=w(()=>M[V.value]),d=w(()=>{if(!l.value)return[];if(u.value=="artists")return l.value.artists;if(u.value=="albums")return l.value.albums;if(u.value=="tracks")return l.value.tracks;if(u.value=="playlists")return l.value.playlists;if(u.value=="radios")return l.value.radio;if(u.value=="topresult"){const e=[];for(const t of[l.value.tracks,l.value.artists,l.value.albums,l.value.playlists,l.value.radio]){const a=[];for(const p of t)a.includes(p.provider)||(e.push(p),a.push(p.provider))}return e}return[]});L(()=>u.value,e=>{if(e){const t=localStorage.getItem(`viewMode.search.${u.value}`);t?r.value=t:u.value=="artists"||u.value=="albums"?r.value="panel":r.value="list"}},{immediate:!0}),J(()=>{if($.initSearch)o.value=$.initSearch;else{const e=localStorage.getItem("globalsearch");e&&e!=="null"&&(o.value=e)}});const I=function(e){f.value||(e.key==="a"&&(e.ctrlKey||e.metaKey)?(e.preventDefault(),c.value=d.value):!m.value&&e.key=="Backspace"?o.value=o.value.slice(0,-1):!m.value&&e.key.length==1&&(o.value+=e.key))};return document.addEventListener("keydown",I),Q(()=>{document.removeEventListener("keydown",I)}),(e,t)=>(v(),h("div",null,[s(te,null,{default:n(()=>[s(ae,{id:"searchInput",modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=a=>o.value=a),clearable:"","prepend-inner-icon":"mdi-magnify",label:e.$t("type_to_search"),"hide-details":"",variant:"filled",onFocus:t[1]||(t[1]=a=>m.value=!0),onBlur:t[2]||(t[2]=a=>m.value=!1)},null,8,["modelValue","label"]),k("div",null,[s(le,{modelValue:V.value,"onUpdate:modelValue":t[3]||(t[3]=a=>V.value=a),column:"",style:{"margin-top":"15px","margin-left":"10px"}},{default:n(()=>[(v(),h(x,null,S(M,a=>s(se,{key:a,filter:"",outlined:""},{default:n(()=>[Z(_(e.$t(a)),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),s(q,{modelValue:f.value,"onUpdate:modelValue":t[4]||(t[4]=a=>f.value=a),items:c.value,onClear:t[5]||(t[5]=()=>{c.value=[]})},null,8,["modelValue","items"]),y.value?(v(),g(me,{key:0,indeterminate:""})):b("",!0),r.value=="panel"?(v(),g(re,{key:1},{default:n(()=>[(v(!0),h(x,null,S(d.value,a=>(v(),g(oe,{key:a.uri,class:z(`col-${K(e.$vuetify.display.width)}`)},{default:n(()=>[s(ee,{item:a,size:D.value,"is-selected":!1,"show-checkboxes":!1,onMenu:B,onClick:F},null,8,["item","size"])]),_:2},1032,["class"]))),128))]),_:1})):b("",!0),r.value=="list"?(v(),h("div",fe,[s(X(G),{items:d.value,"item-size":60,"key-field":"item_id","page-mode":""},{default:n(({item:a})=>[s(A,{item:a,"show-track-number":!1,"show-duration":!0,"show-library":!1,"show-menu":!0,"show-provider":!0,"show-checkboxes":!1,"is-selected":!1,"show-details":!0,onMenu:B,onClick:F},null,8,["item"])]),_:1},8,["items"])])):b("",!0),s(ue,{density:"compact",variant:"flat",color:"transparent",height:"45"},{default:n(()=>[k("span",ce,_(e.$t("items_total",[d.value.length])),1),s(ie),s(ne,{location:"bottom"},{activator:n(({props:a})=>[s(ve,Y(a,{icon:r.value=="panel"?"mdi-view-list":"mdi-grid",variant:"plain",onClick:t[6]||(t[6]=p=>E())}),null,16,["icon"])]),default:n(()=>[k("span",null,_(e.$t("tooltip.toggle_view_mode")),1)]),_:1})]),_:1})])]),_:1})]))}});export{xe as default};

import{_ as ye,L as he,i as ke,s as we}from"./ListviewItem-2bd74fad.js";/* empty css                             */import{p as Ce,m as Ve,as as Se,g as _e,f as $e,d as Ie,r as g,w as z,o as j,j as r,k as N,at as Me,au as Ae,q as m,y as I,Y as U,M as y,L as O,N as F,n as le,a5 as Ne,a6 as Fe,l as Le,O as Pe,I as Be,b as Oe,x as d,B as b,v as $,F as Q,z as X,A as Z,K,W as ze,D as w}from"./index-ade73b84.js";import{_ as Ee}from"./PanelviewItem.vue_vue_type_style_index_0_lang-93dbfb68.js";import{C as Te,L as De}from"./Container-282a676b.js";import{A as x}from"./Alert-4d78da02.js";import{a as ee}from"./VCard-f3e11b51.js";import{V as Re}from"./VToolbar-806969a3.js";import{V as qe}from"./VSpacer-159b0383.js";import{o as Ke,p as He,c as Ue,q as je,r as Ge,s as We,v as Ye,g as Je,i as Qe,w as Xe,x as Ze,l as P,V as D,k as xe}from"./VBtn-61e39030.js";import{V as et}from"./VBadge-12aff0c7.js";import{m as tt,a as at,c as te,f as ot,V as lt,b as nt}from"./VMenu-ccc026f2.js";import{V as ae}from"./VDivider-adefbf87.js";import{V as it}from"./VSelect-a66ffc02.js";import{V as st,a as rt}from"./VRow-74a0e5a5.js";const ut=Ce({multiLine:Boolean,timeout:{type:[Number,String],default:5e3},vertical:Boolean,...Ke({location:"bottom"}),...He(),...Ue(),...je(),...Ve(),...Se(tt({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},"VSnackbar"),ct=_e()({name:"VSnackbar",props:ut(),emits:{"update:modelValue":a=>!0},setup(a,p){let{slots:t}=p;const s=$e(a,"modelValue"),{locationStyles:C}=Ge(a),{positionClasses:v}=We(a),{scopeId:n}=at(),{themeClasses:S}=Ie(a),{colorClasses:L,colorStyles:V,variantClasses:_}=Ye(a),{roundedClasses:l}=Je(a),o=g();z(s,f),z(()=>a.timeout,f),j(()=>{s.value&&f()});let k=-1;function f(){window.clearTimeout(k);const c=Number(a.timeout);!s.value||c===-1||(k=window.setTimeout(()=>{s.value=!1},c))}function h(){window.clearTimeout(k)}return Qe(()=>{const[c]=te.filterProps(a);return r(te,N({ref:o,class:["v-snackbar",{"v-snackbar--active":s.value,"v-snackbar--multi-line":a.multiLine&&!a.vertical,"v-snackbar--vertical":a.vertical},v.value,a.class],style:a.style},c,{modelValue:s.value,"onUpdate:modelValue":M=>s.value=M,contentProps:N({class:["v-snackbar__wrapper",S.value,L.value,l.value,_.value],style:[C.value,V.value],onPointerenter:h,onPointerleave:f},c.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0},n),{default:()=>[Xe(!1,"v-snackbar"),t.default&&r("div",{class:"v-snackbar__content",role:"status","aria-live":"polite"},[t.default()]),t.actions&&r(Ze,{defaults:{VBtn:{variant:"text",ripple:!1}}},{default:()=>[r("div",{class:"v-snackbar__actions"},[t.actions()])]})],activator:t.activator})}),ot({},o)}}),ne=(a,p)=>{const t=a.__vccOpts||a;for(const[s,C]of p)t[s]=C;return t},dt={},mt=a=>(Ne("data-v-259be2b2"),a=a(),Fe(),a),vt={class:"container"},ft=mt(()=>O("div",{class:"spinner"},null,-1)),pt=[ft];function gt(a,p){return m(),I("div",vt,pt)}const bt=ne(dt,[["render",gt],["__scopeId","data-v-259be2b2"],["__file","/home/oumoussa/side-projects/infinite/src/components/Spinner.vue"]]),yt=a=>({loading(){a.value="loading"},loaded(){a.value="loaded"},complete(){a.value="complete"},error(){a.value="error"}}),ht=(a,p,t)=>()=>{const s=t.parentEl||document.documentElement;t.prevHeight=s.scrollHeight,p.loading(),a("infinite",p)},kt=(a,p)=>{const t=a.getBoundingClientRect();if(!p)return t.top>=0&&t.bottom<=window.innerHeight;const s=p.getBoundingClientRect();return t.top>=s.top&&t.bottom<=s.bottom},oe=a=>{a.parentEl=document.querySelector(a.target)||null;let p=`0px 0px ${a.distance}px 0px`;a.top&&(p=`${a.distance}px 0px 0px 0px`);const t=new IntersectionObserver(s=>{s[0].isIntersecting&&(a.firstload&&a.emit(),a.firstload=!0)},{root:a.parentEl,rootMargin:p});return t.observe(a.infiniteLoading.value),t},wt={class:"state-error"},Ct={__name:"InfiniteLoading",props:{top:{type:Boolean,required:!1},target:{type:[String,Boolean],required:!1},distance:{type:Number,required:!1,default:0},identifier:{required:!1},firstload:{type:Boolean,required:!1,default:!0},slots:{type:Object,required:!1}},emits:["infinite"],setup(a,{emit:p}){const t=a;let s=null;const C=g(null),v=g("ready"),{top:n,firstload:S,target:L,distance:V}=t,{identifier:_}=Me(t),l={infiniteLoading:C,target:L,top:n,firstload:S,distance:V,prevHeight:0,parentEl:null};l.emit=ht(p,yt(v),l);const o=()=>z(v,async f=>{const h=l.parentEl||document.documentElement;await le(),f=="loaded"&&n&&(h.scrollTop=h.scrollHeight-l.prevHeight),f=="loaded"&&kt(C.value,l.parentEl)&&l.emit(),f=="complete"&&s.disconnect()}),k=()=>z(_,()=>{v.value="ready",s.disconnect(),s=oe(l)});return j(()=>{s=oe(l),o(),_&&k()}),Ae(()=>{s.disconnect()}),(f,h)=>(m(),I("div",{ref_key:"infiniteLoading",ref:C},[v.value=="loading"?U(f.$slots,"spinner",{key:0},()=>[r(bt)],!0):y("v-if",!0),v.value=="complete"?U(f.$slots,"complete",{key:1},()=>{var c;return[O("span",null,F(((c=a.slots)==null?void 0:c.complete)||"No more results!"),1)]},!0):y("v-if",!0),v.value=="error"?U(f.$slots,"error",{key:2,retry:l.emit},()=>{var c;return[O("span",wt,[O("span",null,F(((c=a.slots)==null?void 0:c.error)||"Oops something went wrong!"),1),O("button",{class:"retry",onClick:h[0]||(h[0]=(...M)=>l.emit&&l.emit(...M))}," retry ")])]},!0):y("v-if",!0)],512))}},Vt=ne(Ct,[["__scopeId","data-v-9d82030b"],["__file","/home/oumoussa/side-projects/infinite/src/components/InfiniteLoading.vue"]]);const St={key:0},_t={key:0},$t={key:2},It={key:3},Mt={style:{height:"30px","margin-top":"20px"}},Ut=function(a,p,t,s,C,v=!0){var V,_;let n=[];if(C){const l=C.toLowerCase();for(const o of a)(o.name.toLowerCase().includes(l)||"artist"in o&&((V=o.artist)!=null&&V.name.toLowerCase().includes(l))||"album"in o&&((_=o.album)!=null&&_.name.toLowerCase().includes(l))||"artists"in o&&o.artists&&o.artists[0].name.toLowerCase().includes(l))&&n.push(o)}else n=a;s=="sort_name"&&n.sort((l,o)=>(l.sort_name||l.name).localeCompare(o.sort_name||o.name)),s=="sort_album"&&n.sort((l,o)=>{var k,f;return(f=l.album)==null?void 0:f.name.localeCompare((k=o.album)==null?void 0:k.name)}),s=="sort_artist"&&n.sort((l,o)=>l.artists[0].name.localeCompare(o.artists[0].name)),s=="track_number"&&(n.sort((l,o)=>(l.track_number||0)-(o.track_number||0)),n.sort((l,o)=>(l.disc_number||0)-(o.disc_number||0))),s=="position"&&n.sort((l,o)=>(l.position||0)-(o.position||0)),s=="position DESC"&&n.sort((l,o)=>(o.position||0)-(l.position||0)),s=="year"&&n.sort((l,o)=>(l.year||0)-(o.year||0)),s=="timestamp_added DESC"&&n.sort((l,o)=>(o.timestamp_added||0)-(l.timestamp_added||0)),s=="duration"&&n.sort((l,o)=>(l.duration||0)-(o.duration||0)),s=="provider"&&n.sort((l,o)=>l.provider.localeCompare(o.provider)),v&&(n=n.filter(l=>l.favorite));const S=n.length,L=n.slice(p,p+t);return{items:L,count:L.length,limit:t,offset:p,total:S}},jt=Le({__name:"ItemsListing",props:{itemtype:{},sortKeys:{default:()=>["sort_name","timestamp_added DESC"]},showTrackNumber:{type:Boolean,default:!0},showProvider:{type:Boolean,default:Object.keys(Pe.providers).length>1},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavoritesOnlyFilter:{type:Boolean,default:!0},showDuration:{type:Boolean,default:!0},parentItem:{default:void 0},showAlbumArtistsOnlyFilter:{type:Boolean},updateAvailable:{type:Boolean},title:{},hideOnEmpty:{type:Boolean,default:!1},checksum:{default:void 0},loadData:{}},emits:["refreshClicked"],setup(a,{emit:p}){const t=a,s=100,C=Be(),v=g("list"),n=g(""),S=g("sort_name"),L=g(!1),V=g(!1),_=g(!1),l=g(0),o=g([]),k=g(),f=g(!1),h=g(!1),c=g([]),M=g(!1),ie=g(!1),E=g(!1),T=g(!0),se=function(){V.value?V.value=!1:(V.value=!0,le(()=>{var e;(e=document.getElementById("searchInput"))==null||e.focus()}))},re=function(e){return w({breakpoint:"bp1",condition:"lt",offset:b.sizeNavigationMenu})?2:w({breakpoint:"bp1",condition:"gt",offset:b.sizeNavigationMenu})&&w({breakpoint:"bp4",condition:"lt",offset:b.sizeNavigationMenu})?3:w({breakpoint:"bp4",condition:"gt",offset:b.sizeNavigationMenu})&&w({breakpoint:"bp6",condition:"lt",offset:b.sizeNavigationMenu})?4:w({breakpoint:"bp6",condition:"gt",offset:b.sizeNavigationMenu})&&w({breakpoint:"bp7",condition:"lt",offset:b.sizeNavigationMenu})?5:w({breakpoint:"bp7",condition:"gt",offset:b.sizeNavigationMenu})&&w({breakpoint:"bp8",condition:"lt",offset:b.sizeNavigationMenu})?6:w({breakpoint:"bp8",condition:"gt",offset:b.sizeNavigationMenu})&&w({breakpoint:"bp9",condition:"lt",offset:b.sizeNavigationMenu})?7:w({breakpoint:"bp9",condition:"gt",offset:b.sizeNavigationMenu})&&w({breakpoint:"bp10",condition:"lt",offset:b.sizeNavigationMenu})?8:w({breakpoint:"bp10",condition:"gt",offset:b.sizeNavigationMenu})?9:0},ue=function(){v.value==="panel"?v.value="list":v.value="panel",localStorage.setItem(`viewMode.${t.itemtype}`,v.value)},ce=function(){h.value=!h.value;const e=h.value?"true":"false";localStorage.setItem(`favoriteFilter.${t.itemtype}`,e),A(!0)},de=function(){T.value=!T.value;const e=T.value?"true":"false";localStorage.setItem(`albumArtistsFilter.${t.itemtype}`,e),A(!0)},G=function(e){return c.value.includes(e)},W=function(e,u){if(u)c.value.includes(e)||c.value.push(e);else for(let i=0;i<c.value.length;i++)c.value[i]===e&&c.value.splice(i,1);b.blockGlobalPlayMenu=c.value.length>0},me=function(){c.value=[],E.value=!1,b.blockGlobalPlayMenu=!1},H=function(){c.value.length>0?M.value=!0:E.value=!E.value},ve=function(e){A(!0)},q=function(e){c.value=[e],M.value=!0},fe=function(){A(!0),p("refreshClicked")},Y=function(e){var u;if(!ke(e)){q(e);return}["artist","album","playlist"].includes(e.media_type)||!((u=b.selectedPlayer)!=null&&u.available)?C.push({name:e.media_type,params:{itemId:e.item_id,provider:e.provider}}):q(e)},pe=function(e,u){e!==void 0&&(S.value=e),localStorage.setItem(`sortBy.${t.itemtype}`,S.value),A(!0)},ge=function(e){if(o.value.length==0){e.loaded();return}if(k.value!==void 0&&l.value>=k.value){e.loaded();return}l.value+=s,A().then(()=>{e.loaded()})},be=function(){localStorage.setItem("globalsearch",n.value),C.push({name:"search",params:{initSearch:n.value}})};z(()=>n.value,e=>{e&&(V.value=!0),A(!0)}),z(()=>t.updateAvailable,e=>{e&&o.value.length==0&&A(!0)}),z(()=>t.checksum,e=>{e&&A(!0)});const A=async function(e=!1,u=s){e&&(l.value=0,ie.value=!1),f.value=!0;const i=await t.loadData(l.value,u,S.value,n.value||"",h.value,T.value);l.value?o.value.push(...i.items):o.value=i.items,k.value=i.total,f.value=!1;let B=`search.${t.itemtype}`;t.parentItem&&(B+=t.parentItem.item_id),localStorage.setItem(B,n.value)};j(()=>{const e=localStorage.getItem(`viewMode.${t.itemtype}`);e&&e!=="null"?v.value=e:t.itemtype=="artists"||t.itemtype=="albums"?v.value="panel":v.value="list";const u=localStorage.getItem(`sortBy.${t.itemtype}`);if(u&&u!=="null"?S.value=u:S.value=t.sortKeys[0],t.showFavoritesOnlyFilter!==!1){const R=localStorage.getItem(`favoriteFilter.${t.itemtype}`);R&&R=="true"&&(h.value=!0)}if(t.showAlbumArtistsOnlyFilter!==!1){const R=localStorage.getItem(`albumArtistsFilter.${t.itemtype}`);R&&(T.value=R=="true")}let i=`search.${t.itemtype}`;t.parentItem&&(i+=t.parentItem.item_id);const B=localStorage.getItem(i);B&&B!=="null"&&(console.log("savedSearch",B),n.value=B),A(!0)});const J=function(e){M.value||(e.key==="a"&&(e.ctrlKey||e.metaKey)?(e.preventDefault(),c.value=o.value):!_.value&&e.key=="Backspace"?n.value=n.value.slice(0,-1):!_.value&&e.key.length==1&&(n.value+=e.key,V.value=!0))};return document.addEventListener("keydown",J),Oe(()=>{document.removeEventListener("keydown",J)}),(e,u)=>e.hideOnEmpty&&o.value.length==0?y("",!0):(m(),I("section",St,[r(ye,{modelValue:M.value,"onUpdate:modelValue":u[0]||(u[0]=i=>M.value=i),items:c.value,"parent-item":e.parentItem,onClear:me,onDelete:ve},null,8,["modelValue","items","parent-item"]),r(ee,null,{default:d(()=>[r(Re,{density:"compact",variant:"flat",color:"transparent"},{title:d(()=>[!e.$vuetify.display.mobile&&e.title?(m(),I("span",_t,F(e.title),1)):y("",!0)]),default:d(()=>[r(qe),r(P,N(t,{icon:E.value?"mdi-checkbox-multiple-outline":"mdi-checkbox-multiple-blank-outline",variant:"plain",onClick:H,title:e.$t("tooltip.select_items")}),null,16,["icon","title"]),e.showFavoritesOnlyFilter!==!1?(m(),$(P,N({key:0},t,{icon:"",variant:"plain",onClick:ce,title:e.$t("tooltip.filter_favorites")}),{default:d(()=>[r(D,{icon:h.value?"mdi-heart":"mdi-heart-outline"},null,8,["icon"])]),_:1},16,["title"])):y("",!0),e.showAlbumArtistsOnlyFilter?(m(),$(P,N({key:1},t,{icon:"",variant:"plain",onClick:de,title:e.$t("tooltip.album_artist_filter")}),{default:d(()=>[r(D,{icon:T.value?"mdi-account-music":"mdi-account-music-outline"},null,8,["icon"])]),_:1},16,["title"])):y("",!0),r(P,N(t,{icon:"",variant:"plain",onClick:u[1]||(u[1]=i=>fe()),title:e.updateAvailable?e.$t("tooltip.refresh_new_content"):e.$t("tooltip.refresh")}),{default:d(()=>[r(et,{"model-value":e.updateAvailable,color:"error",dot:""},{default:d(()=>[r(D,{icon:"mdi-refresh"})]),_:1},8,["model-value"])]),_:1},16,["title"]),e.sortKeys.length>1?(m(),$(nt,{key:2,modelValue:L.value,"onUpdate:modelValue":u[2]||(u[2]=i=>L.value=i),location:"bottom end","close-on-content-click":!0},{activator:d(({props:i})=>[r(P,N({icon:""},i,{variant:"plain",title:e.$t("tooltip.sort_options")}),{default:d(()=>[r(D,N(i,{icon:"mdi-sort"}),null,16)]),_:2},1040,["title"])]),default:d(()=>[r(ee,null,{default:d(()=>[r(lt,null,{default:d(()=>[(m(!0),I(Q,null,X(e.sortKeys,i=>(m(),I("div",{key:i},[r(De,{onClick:B=>pe(i)},{title:d(()=>[K(F(e.$t("sort."+i)),1)]),append:d(()=>[S.value==i?(m(),$(D,{key:0,icon:"mdi-check"})):y("",!0)]),_:2},1032,["onClick"]),r(ae)]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])):y("",!0),r(P,N(t,{icon:"",variant:"plain",onClick:u[3]||(u[3]=i=>se()),title:e.$t("tooltip.search")}),{default:d(()=>[r(D,{icon:"mdi-magnify"})]),_:1},16,["title"]),r(P,N(t,{icon:v.value=="panel"?"mdi-view-list":"mdi-grid",variant:"plain",onClick:u[4]||(u[4]=i=>ue()),title:e.$t("tooltip.toggle_view_mode")}),null,16,["icon","title"])]),_:1}),r(ae),V.value?(m(),$(it,{key:0,id:"searchInput",modelValue:n.value,"onUpdate:modelValue":u[5]||(u[5]=i=>n.value=i),clearable:"","prepend-inner-icon":"mdi-magnify",label:e.$t("search"),"hide-details":"",variant:"filled",style:{width:"auto","margin-left":"15px","margin-right":"15px","margin-top":"10px"},onFocus:u[6]||(u[6]=i=>_.value=!0),onBlur:u[7]||(u[7]=i=>_.value=!1)},null,8,["modelValue","label"])):y("",!0),r(Te,null,{default:d(()=>[f.value?(m(),$(xe,{key:0,indeterminate:""})):y("",!0),v.value=="panel"?(m(),$(st,{key:1},{default:d(()=>[(m(!0),I(Q,null,X(o.value,i=>(m(),$(rt,{key:i.uri,class:ze(`col-${re(e.$vuetify.display.width)}`)},{default:d(()=>[r(Ee,{item:i,"is-selected":G(i),"show-checkboxes":E.value,"show-track-number":e.showTrackNumber,onSelect:W,onMenu:q,onClick:Y},null,8,["item","is-selected","show-checkboxes","show-track-number"])]),_:2},1032,["class"]))),128))]),_:1})):y("",!0),v.value=="list"?(m(),I("div",$t,[r(Z(we),{items:o.value,"item-size":70,"key-field":"uri","page-mode":""},{default:d(({item:i})=>[(m(),$(he,{key:i.uri,item:i,"show-track-number":e.showTrackNumber,"show-disc-number":e.showTrackNumber,"show-duration":e.showDuration,"show-favorite":e.showFavoritesOnlyFilter,"show-menu":e.showMenu,"show-provider":e.showProvider,"show-album":e.showAlbum,"show-checkboxes":E.value,"is-selected":G(i),"show-details":e.itemtype.includes("versions"),"parent-item":e.parentItem,onSelect:W,onMenu:q,onClick:Y},null,8,["item","show-track-number","show-disc-number","show-duration","show-favorite","show-menu","show-provider","show-album","show-checkboxes","is-selected","show-details","parent-item"]))]),_:1},8,["items"])])):y("",!0),r(Z(Vt),{onInfinite:ge}),!f.value&&o.value.length==0?(m(),I("div",It,[!f.value&&o.value.length==0&&(n.value||h.value)?(m(),$(x,{key:0,title:e.$t("no_content_filter")},{default:d(()=>[n.value?(m(),$(P,{key:0,style:{"margin-top":"15px"},onClick:be},{default:d(()=>[K(F(e.$t("try_global_search")),1)]),_:1})):y("",!0)]),_:1},8,["title"])):!f.value&&o.value.length==0?(m(),$(x,{key:1},{default:d(()=>[K(F(e.$t("no_content")),1)]),_:1})):y("",!0)])):y("",!0),r(ct,{"model-value":c.value.length>1,timeout:-1,style:{"margin-bottom":"120px"}},{actions:d(()=>[r(P,{color:"primary",variant:"text",onClick:u[8]||(u[8]=i=>M.value=!0)},{default:d(()=>[K(F(e.$t("actions")),1)]),_:1})]),default:d(()=>[O("span",null,F(e.$t("items_selected",[c.value.length])),1)]),_:1},8,["model-value"]),O("div",Mt,[!c.value.length&&k.value?(m(),I("span",{key:0,style:{cursor:"pointer"},onClick:H},F(e.$t("items_total",[k.value])),1)):c.value.length?(m(),I("span",{key:1,style:{cursor:"pointer"},onClick:H},F(e.$t("items_selected",[c.value.length])),1)):y("",!0)])]),_:1})]),_:1})]))}});export{jt as _,Ut as f};

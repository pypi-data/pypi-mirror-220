import{_ as be,L as ye,i as ke,s as we}from"./ListviewItem-e2342ce8.js";/* empty css                             */import{p as Se,m as Ce,as as Ve,g as Ie,f as $e,d as Be,r as h,w as z,o as G,j as c,k as A,at as _e,au as Me,q as m,y as N,Y as j,M as g,L as O,N as B,n as le,a5 as Ae,a6 as Ne,l as Fe,O as Le,I as Pe,b as Oe,x as d,B as b,K as D,A as K,v as w,F as X,z as Z,D as y,W as ze}from"./index-a5bb9833.js";import{_ as Ee}from"./PanelviewItem.vue_vue_type_style_index_0_lang-d218249a.js";import{C as Te,L as De}from"./Container-4773c160.js";import{A as x}from"./Alert-a5ce795e.js";import{a as ee}from"./VCard-04ae357c.js";import{V as Re}from"./VToolbar-b79315e8.js";import{o as qe,p as Ke,c as He,q as Ue,r as je,s as Ge,v as We,g as Ye,i as Je,w as Qe,x as Xe,l as L,V as R,k as Ze}from"./VBtn-629f5316.js";import{V as xe}from"./VBadge-f7d58168.js";import{m as et,a as tt,c as te,f as at,V as ot,b as lt}from"./VMenu-240a4406.js";import{V as ae}from"./VDivider-df9414f0.js";import{V as nt}from"./VSelect-4d69c543.js";import{V as it,a as st}from"./VRow-7d86481a.js";const rt=Se({multiLine:Boolean,timeout:{type:[Number,String],default:5e3},vertical:Boolean,...qe({location:"bottom"}),...Ke(),...He(),...Ue(),...Ce(),...Ve(et({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},"VSnackbar"),ut=Ie()({name:"VSnackbar",props:rt(),emits:{"update:modelValue":a=>!0},setup(a,f){let{slots:t}=f;const s=$e(a,"modelValue"),{locationStyles:C}=je(a),{positionClasses:v}=Ge(a),{scopeId:n}=tt(),{themeClasses:I}=Be(a),{colorClasses:F,colorStyles:V,variantClasses:$}=We(a),{roundedClasses:l}=Ye(a),o=h();z(s,p),z(()=>a.timeout,p),G(()=>{s.value&&p()});let S=-1;function p(){window.clearTimeout(S);const u=Number(a.timeout);!s.value||u===-1||(S=window.setTimeout(()=>{s.value=!1},u))}function k(){window.clearTimeout(S)}return Je(()=>{const[u]=te.filterProps(a);return c(te,A({ref:o,class:["v-snackbar",{"v-snackbar--active":s.value,"v-snackbar--multi-line":a.multiLine&&!a.vertical,"v-snackbar--vertical":a.vertical},v.value,a.class],style:a.style},u,{modelValue:s.value,"onUpdate:modelValue":_=>s.value=_,contentProps:A({class:["v-snackbar__wrapper",I.value,F.value,l.value,$.value],style:[C.value,V.value],onPointerenter:k,onPointerleave:p},u.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0},n),{default:()=>[Qe(!1,"v-snackbar"),t.default&&c("div",{class:"v-snackbar__content",role:"status","aria-live":"polite"},[t.default()]),t.actions&&c(Xe,{defaults:{VBtn:{variant:"text",ripple:!1}}},{default:()=>[c("div",{class:"v-snackbar__actions"},[t.actions()])]})],activator:t.activator})}),at({},o)}}),ne=(a,f)=>{const t=a.__vccOpts||a;for(const[s,C]of f)t[s]=C;return t},ct={},dt=a=>(Ae("data-v-259be2b2"),a=a(),Ne(),a),mt={class:"container"},vt=dt(()=>O("div",{class:"spinner"},null,-1)),pt=[vt];function ft(a,f){return m(),N("div",mt,pt)}const ht=ne(ct,[["render",ft],["__scopeId","data-v-259be2b2"],["__file","/home/oumoussa/side-projects/infinite/src/components/Spinner.vue"]]),gt=a=>({loading(){a.value="loading"},loaded(){a.value="loaded"},complete(){a.value="complete"},error(){a.value="error"}}),bt=(a,f,t)=>()=>{const s=t.parentEl||document.documentElement;t.prevHeight=s.scrollHeight,f.loading(),a("infinite",f)},yt=(a,f)=>{const t=a.getBoundingClientRect();if(!f)return t.top>=0&&t.bottom<=window.innerHeight;const s=f.getBoundingClientRect();return t.top>=s.top&&t.bottom<=s.bottom},oe=a=>{a.parentEl=document.querySelector(a.target)||null;let f=`0px 0px ${a.distance}px 0px`;a.top&&(f=`${a.distance}px 0px 0px 0px`);const t=new IntersectionObserver(s=>{s[0].isIntersecting&&(a.firstload&&a.emit(),a.firstload=!0)},{root:a.parentEl,rootMargin:f});return t.observe(a.infiniteLoading.value),t},kt={class:"state-error"},wt={__name:"InfiniteLoading",props:{top:{type:Boolean,required:!1},target:{type:[String,Boolean],required:!1},distance:{type:Number,required:!1,default:0},identifier:{required:!1},firstload:{type:Boolean,required:!1,default:!0},slots:{type:Object,required:!1}},emits:["infinite"],setup(a,{emit:f}){const t=a;let s=null;const C=h(null),v=h("ready"),{top:n,firstload:I,target:F,distance:V}=t,{identifier:$}=_e(t),l={infiniteLoading:C,target:F,top:n,firstload:I,distance:V,prevHeight:0,parentEl:null};l.emit=bt(f,gt(v),l);const o=()=>z(v,async p=>{const k=l.parentEl||document.documentElement;await le(),p=="loaded"&&n&&(k.scrollTop=k.scrollHeight-l.prevHeight),p=="loaded"&&yt(C.value,l.parentEl)&&l.emit(),p=="complete"&&s.disconnect()}),S=()=>z($,()=>{v.value="ready",s.disconnect(),s=oe(l)});return G(()=>{s=oe(l),o(),$&&S()}),Me(()=>{s.disconnect()}),(p,k)=>(m(),N("div",{ref_key:"infiniteLoading",ref:C},[v.value=="loading"?j(p.$slots,"spinner",{key:0},()=>[c(ht)],!0):g("v-if",!0),v.value=="complete"?j(p.$slots,"complete",{key:1},()=>{var u;return[O("span",null,B(((u=a.slots)==null?void 0:u.complete)||"No more results!"),1)]},!0):g("v-if",!0),v.value=="error"?j(p.$slots,"error",{key:2,retry:l.emit},()=>{var u;return[O("span",kt,[O("span",null,B(((u=a.slots)==null?void 0:u.error)||"Oops something went wrong!"),1),O("button",{class:"retry",onClick:k[0]||(k[0]=(..._)=>l.emit&&l.emit(..._))}," retry ")])]},!0):g("v-if",!0)],512))}},St=ne(wt,[["__scopeId","data-v-9d82030b"],["__file","/home/oumoussa/side-projects/infinite/src/components/InfiniteLoading.vue"]]);const Ct={key:0},Vt={key:2},It={key:3},$t={style:{height:"30px","margin-top":"20px"}},qt=function(a,f,t,s,C,v=!0){var V,$;let n=[];if(C){const l=C.toLowerCase();for(const o of a)(o.name.toLowerCase().includes(l)||"artist"in o&&((V=o.artist)!=null&&V.name.toLowerCase().includes(l))||"album"in o&&(($=o.album)!=null&&$.name.toLowerCase().includes(l))||"artists"in o&&o.artists&&o.artists[0].name.toLowerCase().includes(l))&&n.push(o)}else n=a;s=="sort_name"&&n.sort((l,o)=>(l.sort_name||l.name).localeCompare(o.sort_name||o.name)),s=="sort_album"&&n.sort((l,o)=>{var S,p;return(p=l.album)==null?void 0:p.name.localeCompare((S=o.album)==null?void 0:S.name)}),s=="sort_artist"&&n.sort((l,o)=>l.artists[0].name.localeCompare(o.artists[0].name)),s=="track_number"&&(n.sort((l,o)=>(l.track_number||0)-(o.track_number||0)),n.sort((l,o)=>(l.disc_number||0)-(o.disc_number||0))),s=="position"&&n.sort((l,o)=>(l.position||0)-(o.position||0)),s=="position DESC"&&n.sort((l,o)=>(o.position||0)-(l.position||0)),s=="year"&&n.sort((l,o)=>(l.year||0)-(o.year||0)),s=="timestamp_added DESC"&&n.sort((l,o)=>(o.timestamp_added||0)-(l.timestamp_added||0)),s=="duration"&&n.sort((l,o)=>(l.duration||0)-(o.duration||0)),s=="provider"&&n.sort((l,o)=>l.provider.localeCompare(o.provider)),v&&(n=n.filter(l=>l.favorite));const I=n.length,F=n.slice(f,f+t);return{items:F,count:F.length,limit:t,offset:f,total:I}},Kt=Fe({__name:"ItemsListing",props:{itemtype:{},sortKeys:{default:()=>["sort_name","timestamp_added DESC"]},showTrackNumber:{type:Boolean,default:!0},showProvider:{type:Boolean,default:Object.keys(Le.providers).length>1},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavoritesOnlyFilter:{type:Boolean,default:!0},showDuration:{type:Boolean,default:!0},parentItem:{default:void 0},showAlbumArtistsOnlyFilter:{type:Boolean},showSearchButton:{type:Boolean,default:void 0},showRefreshButton:{type:Boolean,default:void 0},showSelectButton:{type:Boolean,default:void 0},updateAvailable:{type:Boolean},title:{},hideOnEmpty:{type:Boolean,default:!1},checksum:{default:void 0},loadData:{}},emits:["refreshClicked"],setup(a,{emit:f}){const t=a,s=100,C=Pe(),v=h("list"),n=h(""),I=h("sort_name"),F=h(!1),V=h(!1),$=h(!1),l=h(0),o=h([]),S=h(),p=h(!1),k=h(!1),u=h([]),_=h(!1),ie=h(!1),E=h(!1),T=h(!0),se=function(){V.value?V.value=!1:(V.value=!0,le(()=>{var e;(e=document.getElementById("searchInput"))==null||e.focus()}))},re=function(e){return y({breakpoint:"bp1",condition:"lt",offset:b.sizeNavigationMenu})?2:y({breakpoint:"bp1",condition:"gt",offset:b.sizeNavigationMenu})&&y({breakpoint:"bp4",condition:"lt",offset:b.sizeNavigationMenu})?3:y({breakpoint:"bp4",condition:"gt",offset:b.sizeNavigationMenu})&&y({breakpoint:"bp6",condition:"lt",offset:b.sizeNavigationMenu})?4:y({breakpoint:"bp6",condition:"gt",offset:b.sizeNavigationMenu})&&y({breakpoint:"bp7",condition:"lt",offset:b.sizeNavigationMenu})?5:y({breakpoint:"bp7",condition:"gt",offset:b.sizeNavigationMenu})&&y({breakpoint:"bp8",condition:"lt",offset:b.sizeNavigationMenu})?6:y({breakpoint:"bp8",condition:"gt",offset:b.sizeNavigationMenu})&&y({breakpoint:"bp9",condition:"lt",offset:b.sizeNavigationMenu})?7:y({breakpoint:"bp9",condition:"gt",offset:b.sizeNavigationMenu})&&y({breakpoint:"bp10",condition:"lt",offset:b.sizeNavigationMenu})?8:y({breakpoint:"bp10",condition:"gt",offset:b.sizeNavigationMenu})?9:0},ue=function(){v.value==="panel"?v.value="list":v.value="panel",localStorage.setItem(`viewMode.${t.itemtype}`,v.value)},ce=function(){k.value=!k.value;const e=k.value?"true":"false";localStorage.setItem(`favoriteFilter.${t.itemtype}`,e),M(!0)},de=function(){T.value=!T.value;const e=T.value?"true":"false";localStorage.setItem(`albumArtistsFilter.${t.itemtype}`,e),M(!0)},W=function(e){return u.value.includes(e)},Y=function(e,r){if(r)u.value.includes(e)||u.value.push(e);else for(let i=0;i<u.value.length;i++)u.value[i]===e&&u.value.splice(i,1);b.blockGlobalPlayMenu=u.value.length>0},me=function(){u.value=[],E.value=!1,b.blockGlobalPlayMenu=!1},U=function(){u.value.length>0?_.value=!0:E.value=!E.value},ve=function(e){M(!0)},H=function(e){u.value=[e],_.value=!0},pe=function(){M(!0),f("refreshClicked")},J=function(e){var r;if(!ke(e)){H(e);return}["artist","album","playlist"].includes(e.media_type)||!((r=b.selectedPlayer)!=null&&r.available)?C.push({name:e.media_type,params:{itemId:e.item_id,provider:e.provider}}):H(e)},fe=function(e,r){e!==void 0&&(I.value=e),localStorage.setItem(`sortBy.${t.itemtype}`,I.value),M(!0)},he=function(e){if(o.value.length==0){e.loaded();return}if(S.value!==void 0&&l.value>=S.value){e.loaded();return}l.value+=s,M().then(()=>{e.loaded()})},ge=function(){localStorage.setItem("globalsearch",n.value),C.push({name:"search",params:{initSearch:n.value}})};z(()=>n.value,e=>{e&&(V.value=!0),M(!0)}),z(()=>t.updateAvailable,e=>{e&&o.value.length==0&&M(!0)}),z(()=>t.checksum,e=>{e&&M(!0)});const M=async function(e=!1,r=s){e&&(l.value=0,ie.value=!1),p.value=!0;const i=await t.loadData(l.value,r,I.value,n.value||"",k.value,T.value);l.value?o.value.push(...i.items):o.value=i.items,S.value=i.total,p.value=!1;let P=`search.${t.itemtype}`;t.parentItem&&(P+=t.parentItem.item_id),localStorage.setItem(P,n.value)};G(()=>{const e=localStorage.getItem(`viewMode.${t.itemtype}`);e&&e!=="null"?v.value=e:t.itemtype=="artists"||t.itemtype=="albums"?v.value="panel":v.value="list";const r=localStorage.getItem(`sortBy.${t.itemtype}`);if(r&&r!=="null"?I.value=r:I.value=t.sortKeys[0],t.showFavoritesOnlyFilter!==!1){const q=localStorage.getItem(`favoriteFilter.${t.itemtype}`);q&&q=="true"&&(k.value=!0)}if(t.showAlbumArtistsOnlyFilter!==!1){const q=localStorage.getItem(`albumArtistsFilter.${t.itemtype}`);q&&(T.value=q=="true")}let i=`search.${t.itemtype}`;t.parentItem&&(i+=t.parentItem.item_id);const P=localStorage.getItem(i);P&&P!=="null"&&(console.log("savedSearch",P),n.value=P),M(!0)});const Q=function(e){_.value||(e.key==="a"&&(e.ctrlKey||e.metaKey)?(e.preventDefault(),u.value=o.value):!$.value&&e.key=="Backspace"?n.value=n.value.slice(0,-1):!$.value&&e.key.length==1&&(n.value+=e.key,V.value=!0))};return document.addEventListener("keydown",Q),Oe(()=>{document.removeEventListener("keydown",Q)}),(e,r)=>e.hideOnEmpty&&o.value.length==0?g("",!0):(m(),N("section",Ct,[c(be,{modelValue:_.value,"onUpdate:modelValue":r[0]||(r[0]=i=>_.value=i),items:u.value,"parent-item":e.parentItem,onClear:me,onDelete:ve},null,8,["modelValue","items","parent-item"]),c(ee,null,{default:d(()=>[c(Re,{density:"compact",variant:"flat",color:"transparent"},{title:d(()=>[D(B(e.title),1)]),append:d(()=>[(e.showSelectButton!=null?e.showSelectButton:K(y)("bp1")||!e.title)?(m(),w(L,A({key:0},t,{icon:E.value?"mdi-checkbox-multiple-outline":"mdi-checkbox-multiple-blank-outline",variant:"plain",onClick:U,title:e.$t("tooltip.select_items")}),null,16,["icon","title"])):g("",!0),D(" "+B(e.showSelectButton)+" ",1),e.showFavoritesOnlyFilter!==!1?(m(),w(L,A({key:1},t,{icon:"",variant:"plain",onClick:ce,title:e.$t("tooltip.filter_favorites")}),{default:d(()=>[c(R,{icon:k.value?"mdi-heart":"mdi-heart-outline"},null,8,["icon"])]),_:1},16,["title"])):g("",!0),e.showAlbumArtistsOnlyFilter?(m(),w(L,A({key:2},t,{icon:"",variant:"plain",onClick:de,title:e.$t("tooltip.album_artist_filter")}),{default:d(()=>[c(R,{icon:T.value?"mdi-account-music":"mdi-account-music-outline"},null,8,["icon"])]),_:1},16,["title"])):g("",!0),(e.showRefreshButton!=null?e.showRefreshButton:K(y)("bp1")||!e.title)?(m(),w(L,A({key:3},t,{icon:"",variant:"plain",onClick:r[1]||(r[1]=i=>pe()),title:e.updateAvailable?e.$t("tooltip.refresh_new_content"):e.$t("tooltip.refresh")}),{default:d(()=>[c(xe,{"model-value":e.updateAvailable,color:"error",dot:""},{default:d(()=>[c(R,{icon:"mdi-refresh"})]),_:1},8,["model-value"])]),_:1},16,["title"])):g("",!0),e.sortKeys.length>1?(m(),w(lt,{key:4,modelValue:F.value,"onUpdate:modelValue":r[2]||(r[2]=i=>F.value=i),location:"bottom end","close-on-content-click":!0},{activator:d(({props:i})=>[c(L,A({icon:""},i,{variant:"plain",title:e.$t("tooltip.sort_options")}),{default:d(()=>[c(R,A(i,{icon:"mdi-sort"}),null,16)]),_:2},1040,["title"])]),default:d(()=>[c(ee,null,{default:d(()=>[c(ot,null,{default:d(()=>[(m(!0),N(X,null,Z(e.sortKeys,i=>(m(),N("div",{key:i},[c(De,{onClick:P=>fe(i)},{title:d(()=>[D(B(e.$t("sort."+i)),1)]),append:d(()=>[I.value==i?(m(),w(R,{key:0,icon:"mdi-check"})):g("",!0)]),_:2},1032,["onClick"]),c(ae)]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])):g("",!0),(e.showSearchButton!=null?e.showSearchButton:K(y)("bp1")||!e.title)?(m(),w(L,A({key:5},t,{icon:"",variant:"plain",onClick:r[3]||(r[3]=i=>se()),title:e.$t("tooltip.search")}),{default:d(()=>[c(R,{icon:"mdi-magnify"})]),_:1},16,["title"])):g("",!0),c(L,A(t,{icon:v.value=="panel"?"mdi-view-list":"mdi-grid",variant:"plain",onClick:r[4]||(r[4]=i=>ue()),title:e.$t("tooltip.toggle_view_mode")}),null,16,["icon","title"])]),_:1}),c(ae),V.value?(m(),w(nt,{key:0,id:"searchInput",modelValue:n.value,"onUpdate:modelValue":r[5]||(r[5]=i=>n.value=i),clearable:"","prepend-inner-icon":"mdi-magnify",label:e.$t("search"),"hide-details":"",variant:"filled",style:{width:"auto","margin-left":"15px","margin-right":"15px","margin-top":"10px"},onFocus:r[6]||(r[6]=i=>$.value=!0),onBlur:r[7]||(r[7]=i=>$.value=!1)},null,8,["modelValue","label"])):g("",!0),c(Te,null,{default:d(()=>[p.value?(m(),w(Ze,{key:0,indeterminate:""})):g("",!0),v.value=="panel"?(m(),w(it,{key:1},{default:d(()=>[(m(!0),N(X,null,Z(o.value,i=>(m(),w(st,{key:i.uri,class:ze(`col-${re(e.$vuetify.display.width)}`)},{default:d(()=>[c(Ee,{item:i,"is-selected":W(i),"show-checkboxes":E.value,"show-track-number":e.showTrackNumber,onSelect:Y,onMenu:H,onClick:J},null,8,["item","is-selected","show-checkboxes","show-track-number"])]),_:2},1032,["class"]))),128))]),_:1})):g("",!0),v.value=="list"?(m(),N("div",Vt,[c(K(we),{items:o.value,"item-size":70,"key-field":"uri","page-mode":""},{default:d(({item:i})=>[(m(),w(ye,{key:i.uri,item:i,"show-track-number":e.showTrackNumber,"show-disc-number":e.showTrackNumber,"show-duration":e.showDuration,"show-favorite":e.showFavoritesOnlyFilter,"show-menu":e.showMenu,"show-provider":e.showProvider,"show-album":e.showAlbum,"show-checkboxes":E.value,"is-selected":W(i),"show-details":e.itemtype.includes("versions"),"parent-item":e.parentItem,onSelect:Y,onMenu:H,onClick:J},null,8,["item","show-track-number","show-disc-number","show-duration","show-favorite","show-menu","show-provider","show-album","show-checkboxes","is-selected","show-details","parent-item"]))]),_:1},8,["items"])])):g("",!0),c(K(St),{onInfinite:he}),!p.value&&o.value.length==0?(m(),N("div",It,[!p.value&&o.value.length==0&&(n.value||k.value)?(m(),w(x,{key:0,title:e.$t("no_content_filter")},{default:d(()=>[n.value?(m(),w(L,{key:0,style:{"margin-top":"15px"},onClick:ge},{default:d(()=>[D(B(e.$t("try_global_search")),1)]),_:1})):g("",!0)]),_:1},8,["title"])):!p.value&&o.value.length==0?(m(),w(x,{key:1},{default:d(()=>[D(B(e.$t("no_content")),1)]),_:1})):g("",!0)])):g("",!0),c(ut,{"model-value":u.value.length>1,timeout:-1,style:{"margin-bottom":"120px"}},{actions:d(()=>[c(L,{color:"primary",variant:"text",onClick:r[8]||(r[8]=i=>_.value=!0)},{default:d(()=>[D(B(e.$t("actions")),1)]),_:1})]),default:d(()=>[O("span",null,B(e.$t("items_selected",[u.value.length])),1)]),_:1},8,["model-value"]),O("div",$t,[!u.value.length&&S.value?(m(),N("span",{key:0,style:{cursor:"pointer"},onClick:U},B(e.$t("items_total",[S.value])),1)):u.value.length?(m(),N("span",{key:1,style:{cursor:"pointer"},onClick:U},B(e.$t("items_selected",[u.value.length])),1)):g("",!0)])]),_:1})]),_:1})]))}});export{Kt as _,qt as f};

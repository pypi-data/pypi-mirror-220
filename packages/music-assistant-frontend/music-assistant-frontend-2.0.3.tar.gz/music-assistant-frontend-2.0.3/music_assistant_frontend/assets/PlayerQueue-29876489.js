import{l as Y,J as Z,I as Q,r as M,c as w,B as k,O as n,o as ee,af as x,b as le,w as te,q as p,y as U,j as t,x as a,K as $,N as d,v as f,L as v,M as _,A as V,k as J,ai as h,a2 as ue,U as ae}from"./index-e9211ef1.js";import{L as oe,s as ie}from"./ListviewItem-b7a4258b.js";/* empty css                             */import{C as ne,L as g}from"./Container-349a0ac0.js";import{A as O}from"./Alert-55091fd0.js";import{V as P,a as se}from"./VTabs-13127e50.js";import{V as F}from"./MediaItemThumb.vue_vue_type_style_index_0_lang-278977b5.js";import{l as A,V as q}from"./VBtn-68784d55.js";import{a as re,c as de}from"./VCard-138864fc.js";import{V as me,b as G}from"./VToolbar-daf2b89f.js";import{V as pe}from"./VMenu-bc0cce60.js";import{a as y}from"./VListItem-230d1393.js";import{V as C}from"./VDivider-336c24cd.js";import{V as ve}from"./VDialog-5f240a62.js";import"./VSelect-04a129eb.js";/* empty css              */const fe=v("br",null,null,-1),_e={key:0},be={key:0},ce={key:1},Le=Y({__name:"PlayerQueue",setup(ge){const{t:H}=Z(),B=Q(),E=M(0),s=M(),T=M(!1),b=M([]),e=w(()=>{if(k.selectedPlayer)return n.queues[k.selectedPlayer.active_source]}),W=w(()=>{if(e.value)return e.value.current_item}),L=w(()=>e.value?b.value.slice(e.value.current_index):[]),N=w(()=>e.value?b.value.slice(0,e.value.current_index):[]),X=w(()=>E.value==1?N.value:L.value);ee(()=>{const l=n.subscribe_multi([x.QUEUE_UPDATED,x.QUEUE_ITEMS_UPDATED],u=>{var o;u.object_id==((o=e.value)==null?void 0:o.queue_id)&&(u.event==x.QUEUE_ITEMS_UPDATED?S():j())});le(l)});const S=async function(){e.value?(k.topBarTitle=e.value.display_name,b.value=[],await n.getPlayerQueueItems(e.value.queue_id,l=>{console.log("chunk",l.length),b.value.push(...l)})):(k.topBarTitle=void 0,b.value=[])},z=function(l){s.value=l,T.value=!0},R=function(l){D(),B.push({name:l.media_type,params:{itemId:l.item_id,provider:l.provider}})},c=function(l,u){D(),!(!l||!e.value)&&(u=="play_now"?n.queueCommandPlayIndex(e==null?void 0:e.value.queue_id,l.queue_item_id):u=="move_next"?n.queueCommandMoveNext(e==null?void 0:e.value.queue_id,l.queue_item_id):u=="up"?n.queueCommandMoveUp(e==null?void 0:e.value.queue_id,l.queue_item_id):u=="down"?n.queueCommandMoveDown(e==null?void 0:e.value.queue_id,l.queue_item_id):u=="delete"&&n.queueCommandDelete(e==null?void 0:e.value.queue_id,l.queue_item_id))},j=function(){k.topBarContextMenuItems=[{label:"settings.player_settings",labelArgs:[],action:()=>{B.push(`/settings/editplayer/${e.value.queue_id}`)},icon:"mdi-cog-outline"},{label:"queue_clear",labelArgs:[],action:()=>{n.queueCommandClear(e.value.queue_id)},icon:"mdi-cancel"},{label:e.value.shuffle_enabled?"shuffle_enabled":"shuffle_disabled",labelArgs:[],action:()=>{n.queueCommandShuffleToggle(e.value.queue_id)},icon:e.value.shuffle_enabled?"mdi-shuffle":"mdi-shuffle-disabled"},{label:"repeat_mode",labelArgs:[H(`repeatmode.${e.value.repeat_mode}`)],action:()=>{n.queueCommandRepeatToggle(e.value.queue_id)},icon:e.value.shuffle_enabled?"mdi-repeat":"mdi-repeat-off"},{label:e.value.crossfade_enabled?"crossfade_enabled":"crossfade_disabled",labelArgs:[],action:()=>{n.queueCommandCrossfadeToggle(e.value.queue_id)},icon:e.value.crossfade_enabled?"mdi-swap-horizontal-bold":"mdi-swap-horizontal"}]},D=function(){s.value=void 0,T.value=!1};return te(()=>e.value,l=>{l&&(S(),j())},{immediate:!0}),(l,u)=>(p(),U("section",null,[t(se,{modelValue:E.value,"onUpdate:modelValue":u[0]||(u[0]=o=>E.value=o),"show-arrows":"",grow:""},{default:a(()=>[t(P,{value:0},{default:a(()=>[$(d(l.$t("queue_next_items")+" ("+L.value.length+")"),1)]),_:1}),t(P,{value:1},{default:a(()=>[$(d(l.$t("queue_previous_items")+" ("+N.value.length+")"),1)]),_:1})]),_:1},8,["modelValue"]),t(ne,null,{default:a(()=>{var o;return[e.value&&((o=e.value)==null?void 0:o.radio_source.length)>0?(p(),f(O,{key:0,icon:"mdi-radio-tower"},{default:a(()=>{var i,m,r,I;return[v("b",null,d(l.$t("queue_radio_enabled")),1),fe,$(" "+d(l.$t("queue_radio_based_on",[l.$t((i=e.value)==null?void 0:i.radio_source[0].media_type)]))+" ",1),v("b",null,[v("a",{onClick:u[1]||(u[1]=qe=>{var K;return e.value?R((K=e.value)==null?void 0:K.radio_source[0]):""})},d((m=e.value)==null?void 0:m.radio_source[0].name),1)]),((r=e.value)==null?void 0:r.radio_source.length)>1?(p(),U("span",_e," (+"+d(((I=e.value)==null?void 0:I.radio_source.length)-1)+")",1)):_("",!0)]}),_:1})):_("",!0),t(V(ie),{items:X.value,"item-size":60,"key-field":"queue_item_id","page-mode":""},{default:a(({item:i})=>{var m;return[(p(),f(oe,{key:i.uri,item:i.media_item,"show-disc-number":!1,"show-track-number":!1,"show-duration":!0,"show-library":!0,"show-menu":!0,"show-provider":!1,"show-album":!1,"show-checkboxes":!1,"is-selected":!1,"show-details":!1,"parent-item":i,"is-disabled":i.queue_item_id==((m=W.value)==null?void 0:m.queue_item_id),ripple:"",onMenu:r=>z(i),onClick:r=>c(i,"play_now"),onContextmenu:h(r=>z(i),["right","prevent"])},{append:a(()=>[l.$vuetify.display.mobile?_("",!0):(p(),U("div",be,[t(F,{location:"bottom"},{activator:a(({props:r})=>[t(A,J({variant:"plain",ripple:""},r,{icon:"mdi-arrow-up",onClick:[I=>V(n).queueCommandMoveUp(e.value.queue_id,i.queue_item_id),u[2]||(u[2]=h(()=>{},["prevent"])),u[3]||(u[3]=h(()=>{},["stop"]))]}),null,16,["onClick"])]),default:a(()=>[v("span",null,d(l.$t("queue_move_up")),1)]),_:2},1024)])),l.$vuetify.display.mobile?_("",!0):(p(),U("div",ce,[t(F,{location:"bottom"},{activator:a(({props:r})=>[t(A,J({variant:"plain",ripple:""},r,{icon:"mdi-arrow-down",onClick:[I=>V(n).queueCommandMoveDown(e.value.queue_id,i.queue_item_id),u[4]||(u[4]=h(()=>{},["prevent"])),u[5]||(u[5]=h(()=>{},["stop"]))]}),null,16,["onClick"])]),default:a(()=>[v("span",null,d(l.$t("queue_move_down")),1)]),_:2},1024)]))]),_:2},1032,["item","parent-item","is-disabled","onMenu","onClick","onContextmenu"]))]}),_:1},8,["items"]),b.value.length==0?(p(),f(O,{key:1,type:"info"},{default:a(()=>[$(d(l.$t("no_content")),1)]),_:1})):_("",!0)]}),_:1}),t(ve,{modelValue:T.value,"onUpdate:modelValue":u[13]||(u[13]=o=>T.value=o),fullscreen:l.$vuetify.display.mobile,"min-height":"80%",scrim:!0},{default:a(()=>[t(re,null,{default:a(()=>[t(me,{sense:"",dark:"",color:"primary"},{default:a(()=>[t(A,{icon:"mdi-play-circle-outline"}),s.value?(p(),f(G,{key:0,style:{"padding-left":"10px"}},{default:a(()=>{var o;return[v("b",null,d(V(ue)(((o=s.value)==null?void 0:o.name)||"",l.$vuetify.display.mobile?20:150)),1)]}),_:1})):(p(),f(G,{key:1,style:{"padding-left":"10px"}},{default:a(()=>{var o;return[v("b",null,d(l.$t("settings")),1),$(" | "+d((o=e.value)==null?void 0:o.display_name),1)]}),_:1})),t(A,{icon:"mdi-close",dark:"",onClick:u[6]||(u[6]=o=>D())})]),_:1}),s.value?(p(),f(de,{key:0},{default:a(()=>[t(pe,null,{default:a(()=>{var o,i;return[t(g,{title:l.$t("play_now"),onClick:u[7]||(u[7]=m=>c(s.value,"play_now"))},{prepend:a(()=>[t(y,{style:{"padding-right":"10px"}},{default:a(()=>[t(q,{icon:"mdi-play-circle-outline"})]),_:1})]),_:1},8,["title"]),t(C),t(g,{title:l.$t("play_next"),onClick:u[8]||(u[8]=m=>c(s.value,"move_next"))},{prepend:a(()=>[t(y,{style:{"padding-right":"10px"}},{default:a(()=>[t(q,{icon:"mdi-skip-next-circle-outline"})]),_:1})]),_:1},8,["title"]),t(C),t(g,{title:l.$t("queue_move_up"),onClick:u[9]||(u[9]=m=>c(s.value,"up"))},{prepend:a(()=>[t(y,{style:{"padding-right":"10px"}},{default:a(()=>[t(q,{icon:"mdi-arrow-up"})]),_:1})]),_:1},8,["title"]),t(C),t(g,{title:l.$t("queue_move_down"),onClick:u[10]||(u[10]=m=>c(s.value,"down"))},{prepend:a(()=>[t(y,{style:{"padding-right":"10px"}},{default:a(()=>[t(q,{icon:"mdi-arrow-down"})]),_:1})]),_:1},8,["title"]),t(C),t(g,{title:l.$t("queue_delete"),onClick:u[11]||(u[11]=m=>c(s.value,"delete"))},{prepend:a(()=>[t(y,{style:{"padding-right":"10px"}},{default:a(()=>[t(q,{icon:"mdi-delete"})]),_:1})]),_:1},8,["title"]),t(C),((i=(o=s.value)==null?void 0:o.media_item)==null?void 0:i.media_type)==V(ae).TRACK?(p(),f(g,{key:0,title:l.$t("show_info"),onClick:u[12]||(u[12]=m=>{var r;return(r=s.value)!=null&&r.media_item?R(s.value.media_item):""})},{prepend:a(()=>[t(y,{style:{"padding-right":"10px"}},{default:a(()=>[t(q,{icon:"mdi-information-outline"})]),_:1})]),_:1},8,["title"])):_("",!0),t(C)]}),_:1})]),_:1})):_("",!0)]),_:1})]),_:1},8,["modelValue","fullscreen"])]))}});export{Le as default};
